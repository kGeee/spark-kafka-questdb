<!--
   
   Copyright (c) 2017, the Perspective Authors.
   
   This file is part of the Perspective library, distributed under the terms of
   the Apache License 2.0.  The full license can be found in the LICENSE file.

-->

<!DOCTYPE html>
<html>

<head>
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />

    <script type="module"
        src="https://cdn.jsdelivr.net/npm/@finos/perspective-viewer@2.6.0/dist/cdn/perspective-viewer.js"></script>
    <script type="module"
        src="https://cdn.jsdelivr.net/npm/@finos/perspective-viewer-datagrid@2.6.0/dist/cdn/perspective-viewer-datagrid.js"></script>
    <script type="module"
        src="https://cdn.jsdelivr.net/npm/@finos/perspective-viewer-d3fc@2.6.0/dist/cdn/perspective-viewer-d3fc.js"></script>

    <link rel="stylesheet" crossorigin="anonymous"
        href="https://cdn.jsdelivr.net/npm/@finos/perspective-viewer/dist/css/themes.css" />
    <style>
        perspective-viewer {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
    </style>
</head>

<body>
    <perspective-viewer id="viewer" ,> </perspective-viewer>

    <script type="module">
        import perspective from "https://cdn.jsdelivr.net/npm/@finos/perspective@2.6.0/dist/cdn/perspective.js";
        window.addEventListener("DOMContentLoaded", async function () {
            const viewer = document.getElementById("viewer");

            // Create a client that expects a Perspective server to accept
            // Websocket connections at the specified URL.
            const websocket = perspective.websocket("ws://localhost:8080/websocket");

            /* This shows Perspective running in "server mode": the `table`
            variable is a proxy for the `Table` we created on the server.
            
            All operations that are possible through the Javascript API are
            possible on the Python API as well, thus calling `view()`,
            `schema()`, `update()` etc on `const table` will pass those
            operations to the Python `Table`, execute the commands,
            and return the result back to Javascript.
            */
            const table = websocket.open_table("data_source_one");

            // Load this in the `<perspective-viewer>`.
            viewer.load(table);
            viewer.restore({
                "plugin": "Datagrid", "plugin_config": { "columns": { "amount": { "fg_gradient": 101207.38, "number_fg_mode": "bar" } }, "editable": false, "scroll_lock": false }, "settings": true, "theme": "Pro Light", "title": null, "group_by": [], "split_by": [], "columns": ["ticker", "side", "price", "ts", "amount"], "filter": [], "sort": [["ts", "desc"]], "expressions": [], "aggregates": {}
            });
            // viewer.toggleConfig();
        });
    </script>
</body>

</html>