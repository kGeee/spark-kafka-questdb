var Mo=Object.defineProperty;var it=(e,t)=>{for(var r in t)Mo(e,r,{get:t[r],enumerable:!0})};Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(t!==null&&t.nodeType===1);return null});import*as nn from"d3fc";import*as fe from"d3fc";var C={none:"none",ordinal:"ordinal",time:"time",linear:"linear"},De=e=>{let t="crossValues",r=null,o=null,n=()=>{let a=l=>{let i=r?e[t].filter(c=>r==c.name):e[t];return t=="crossValues"&&i.length>1?!1:i.some(c=>l.includes(c.type))};return e[t].length===0?C.none:o!=C.time&&a(["datetime","date"])?C.time:o!=C.linear&&a(["integer","float"])||o==C.ordinal?C.linear:C.ordinal};return n.settingName=(...a)=>a.length?(t=a[0],n):t,n.settingValue=(...a)=>a.length?(r=a[0],n):r,n.excludeType=(...a)=>a.length?(o=a[0],n):o,n};var It={};it(It,{domain:()=>Ro,labelFunction:()=>$t,scale:()=>Fo});import*as yr from"d3";var hr=e=>{let t=r=>(o,n)=>o===void 0?n:n===void 0?o:r(o,n);return e.reduce((r,o)=>[t(Math.min)(r[0],o[0]),t(Math.max)(r[1],o[1])],[void 0,void 0])},ue=e=>Array.isArray(e)?e.flat(1/0):[e];import{rebindAll as No}from"d3fc";var Do=1,st=e=>{let t=r=>e(r);return No(t,e),t.bandwidth=(...r)=>r.length?(e.bandwidth(...r),t):Math.max(e.bandwidth(),Do),t};import{rebindAll as Po}from"d3fc";var gr=e=>{let t=r=>e(r);return Po(t,e),t.ticks=function(){return[]},t};var Fo=()=>gr(st(yr.scaleBand())),Ro=()=>{let e=["crossValue"],t="horizontal",r=n=>{let a=ue(n);return o([...new Set(a.map(l=>l[e[0]]))])},o=n=>t=="vertical"?n.reverse():n;return r.valueName=(...n)=>n.length?(e=[n[0]],r):e[0],r.valueNames=(...n)=>n.length?(e=n[0],r):e,r.orient=(...n)=>n.length?(t=n[0],r):t,r},$t=e=>t=>t[e].join("|");var Wt={};it(Wt,{component:()=>Ho,domain:()=>jt,labelFunction:()=>Gt,scale:()=>$o,tickFormatFunction:()=>Io});import*as Xe from"d3";import*as Q from"d3fc";import*as me from"d3-array";var ct=()=>{let e=[0,0],t="percent",r=o=>{switch(t){case"domain":{o[0]-=e[0],o[1]+=e[1];break}case"percent":{let n=o[1]-o[0];o[0]-=e[0]*n,o[1]+=e[1]*n;break}default:throw new Error("Unknown padUnit: "+t)}return o};return r.pad=function(){return arguments.length?(e=arguments.length<=0?void 0:arguments[0],r):e},r.padUnit=function(){return arguments.length?(t=arguments.length<=0?void 0:arguments[0],r):t},r};var xr=function(){let e=[function(a){return a}],t=null,r=[],o=ct(),n=function(l){let i=new Array(l.length),c=!0,s=!1,u,d=e[Symbol.iterator]();try{for(let p;!(c=(p=d.next()).done);c=!0){let f=p.value;for(let h=0;h<l.length;h++){let y=f(l[h],h);Array.isArray(y)?i.push.apply(i,Ht(y)):i.push(y)}}}catch(p){s=!0,u=p}finally{try{!c&&d.return&&d.return()}finally{if(s)throw u}}let m=[me.min(i),me.max(i)];if(m[0]=m[0]==null?me.min(r):me.min([m[0]].concat(Ht(r))),m[1]=m[1]==null?me.max(r):me.max([m[1]].concat(Ht(r))),t!=null){let p=Math.max(Math.abs(m[1]-t),Math.abs(m[0]-t));m[0]=t-p,m[1]=t+p}return o(m)};return n.accessors=function(){return arguments.length?(e=arguments.length<=0?void 0:arguments[0],n):e},n.pad=function(){return arguments.length?(o.pad(arguments.length<=0?void 0:arguments[0]),n):o.pad},n.padUnit=function(){return arguments.length?(o.padUnit(arguments.length<=0?void 0:arguments[0]),n):o.padUnit},n.include=function(){return arguments.length?(r=arguments.length<=0?void 0:arguments[0],n):r},n.symmetricalAbout=function(){return arguments.length?(t=arguments.length<=0?void 0:arguments[0],n):t},n.paddingStrategy=function(){return arguments.length?(o=arguments.length<=0?void 0:arguments[0],n):o},n},Ht=function(e){if(Array.isArray(e)){let t=Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r];return t}else return Array.from(e)};import*as ut from"d3";var Bo=1e7,mt=e=>Math.abs(e)>=Bo?ut.format(".3s")(e):Number.isInteger(e)?ut.format(",.0f")(e):ut.format(",.2f")(e);function Pe(e){return e.getRootNode().host}function pe(e){return e.closest("#container.chart")}var $o=()=>Xe.scaleLinear(),jt=()=>{let e=xr().pad([0,.1]).padUnit("percent"),t=["crossValue"],r=a=>(e.accessors(t.map(l=>i=>parseFloat(i[l]))),n(ue(a)));Q.rebindAll(r,e);let o=a=>{let l=t.map(i=>a.map(c=>c[i]).sort((c,s)=>c-s).filter((c,s,u)=>s===0||c!==u[s-1]).reduce((c,s,u,d)=>u===0||c<=s-d[u-1]?c:Math.abs(s-d[u-1])));return Math.min(...l)},n=a=>{if(e.padUnit()=="domain"){let l=o(a);return e.pad([l/2,l/2])(a)}else return e(a)};return r.valueName=(...a)=>a.length?(t=[a[0]],r):t[0],r.valueNames=(...a)=>a.length?(t=a[0],r):t,r},Gt=e=>t=>t[e][0],Io=mt,Ho=e=>{let t=null,r="horizontal",o=null,n=(s,u)=>{try{return pe(s.node()).querySelector(".cartesian-chart").querySelector(`.${u}-axis`)}catch{return null}},a=s=>{let u=Xe.select(s).select("text").node();u.style.fontSize="80%"},l=(s,u)=>{let d=s.getBoundingClientRect();u.each((m,p,f)=>{let h=Xe.select(f[p]).node().getBoundingClientRect();(r=="vertical"&&d.width<h.width||r=="horizontal"&&d.height<h.height)&&a(f[p])})},i=(s,u,d)=>{let m=n(s,u);m&&l(m,s)},c=()=>({bottom:Q.axisBottom,left:Q.axisLeft,top:Q.axisTop,right:Q.axisRight,decorate:i});return c.domain=(...s)=>s.length?(t=s[0],c):t,c.orient=(...s)=>s.length?(r=s[0],c):r,c.settingName=(...s)=>s.length?(o=s[0],c):o,c};var Ut={};it(Ut,{domain:()=>Go,labelFunction:()=>Yt,scale:()=>jo});import*as br from"d3";import*as Fe from"d3fc";var jo=()=>br.scaleTime(),Go=()=>{let e=Fe.extentTime(),t=["crossValue"],r=a=>(e.accessors(t.map(l=>i=>new Date(i[l]))),n(ue(a)));Fe.rebindAll(r,e,Fe.exclude("include","paddingStrategy"));let o=a=>{let l=t.map(i=>a.map(c=>new Date(c[i]).getTime()).sort((c,s)=>c-s).filter((c,s,u)=>s===0||c!==u[s-1]).reduce((c,s,u,d)=>u===0||Math.abs(c)<=Math.abs(s-d[u-1])?Math.abs(c):Math.abs(s-d[u-1])));return Math.min(...l)},n=a=>{let l=Math.abs(o(a));return e.padUnit("domain").pad([l/2,l/2])(a)};return r.valueName=(...a)=>a.length?(t=[a[0]],r):t[0],r.valueNames=(...a)=>a.length?(t=a[0],r):t,r},Yt=e=>t=>new Date(t[e][0]);var qt={};it(qt,{component:()=>Qo,domain:()=>Jo,labelFunction:()=>Kt,scale:()=>Zo});import*as Ze from"d3";import*as de from"d3fc";import{select as wr,line as Wo}from"d3";import{axisOrdinalTop as Yo,axisOrdinalBottom as Uo,axisOrdinalLeft as Ko,axisOrdinalRight as qo,dataJoin as Sr,rebindAll as _r,exclude as Xo}from"d3fc";var vr=(...e)=>{let t={},r=o=>{for(let n of Object.keys(t))o[n](t[n]);return o};for(let o of e)r[o]=(...n)=>n.length?(t[o]=n[0],r):t[o];return r};var pt=(e,t,r)=>{let o=6,n=6,a=vr("tickFormat","ticks","tickArguments","tickValues","tickPadding"),l=()=>{},i=null,c=Sr("g","group"),s=Sr("path","domain"),u=(h,y)=>m()?`translate(${y}, ${h})`:`translate(${h}, ${y})`,d=h=>m()?h.map(y=>[y[1],y[0]]):h,m=()=>e==="left"||e==="right",p=h=>{if(!i){a(t(r).decorate(l))(h);return}h.each((y,g,x)=>{let b=x[g],v=wr(b),S=e==="bottom"||e==="right"?1:-1,_=r.range(),k=d([[_[0],S*o],[_[0],0],[_[1],0],[_[1],S*o]]);s(v,[y]).attr("d",Wo()(k)).attr("stroke","#000").attr("fill","none");let G=c(v,i),M=R=>Array.isArray(n)?n[R]:n,z=R=>{let O=0;for(let H=0;H<R;H++)O+=M(H);return O};G.attr("transform",(R,O)=>u(0,S*z(O))).each((R,O,H)=>{let J=wr(H[O]),X=f(r,R);a(t(X)).decorate((V,T)=>l(V,T,O)).tickSizeInner(M(O)).tickOffset(V=>X.step(V)/2)(J),J.select("path.domain").attr("visibility","hidden")}),G.exit().attr("transform",(R,O)=>u(0,S*z(O)))})},f=(h,y)=>{function g(x){let b=x.domain;return b.reduce((v,S)=>v+h(S),0)/b.length}return g.ticks=()=>y,g.tickFormat=()=>x=>x.text,g.copy=()=>f(h,y),g.step=x=>x.domain.length*h.step(),_r(g,h,Xo("ticks","step","copy")),g};return p.tickSize=(...h)=>h.length?(n=o=Number(h[0]),p):n,p.tickSizeInner=(...h)=>h.length?(n=Array.isArray(h[0])?h[0]:Number(h[0]),p):n,p.tickSizeOuter=(...h)=>h.length?(o=Number(h[0]),p):o,p.decorate=(...h)=>h.length?(l=h[0],p):l,p.groups=(...h)=>h.length?(i=h[0],p):i,_r(p,a),p},Vr=e=>pt("top",Yo,e),Cr=e=>pt("bottom",Uo,e),Ar=e=>pt("left",Ko,e),kr=e=>pt("right",qo,e);var Zo=()=>st(Ze.scaleBand()).padding(.5),Jo=()=>{let e=["crossValue"],t="horizontal",r=n=>{let a=ue(n);return o([...Array.from(new Set(a.map(l=>l[e[0]])))])},o=n=>t=="vertical"?n.reverse():n;return r.valueName=(...n)=>n.length?(e=[n[0]],r):e[0],r.valueNames=(...n)=>n.length?(e=n[0],r):e,r.orient=(...n)=>n.length?(t=n[0],r):t,r},Kt=e=>t=>t[e].join("|"),Qo=e=>{let t="horizontal",r="crossValues",o=null,n=()=>{let m=e[r].length>1,p=l(o),f=p.map(i),h=m?f.map(v=>v.size):f[0].size,y=f.reduce((v,S)=>v+S.size,0),g=v=>S=>{let _=v(S);return m&&_.groups(p).tickSizeInner(h).tickSizeOuter(y),t!=="horizontal"&&_.tickPadding(10),_},x=(v,S,_)=>{let k=f[_].rotation;t==="horizontal"&&d(v,k),c(v,k)},b=a(m);return{bottom:g(b.bottom),left:g(b.left),right:g(b.right),top:g(b.top),size:`${y+10}px`,decorate:x}},a=m=>m?{bottom:Cr,left:Ar,top:Vr,right:kr}:{bottom:de.axisOrdinalBottom,left:de.axisOrdinalLeft,top:de.axisOrdinalTop,right:de.axisOrdinalRight},l=m=>{let p=[];return m.forEach(f=>{(f&&f.split?f.split("|"):[f]).forEach((y,g)=>{for(;p.length<=g;)p.push([]);let x=p[g];x.length>0&&x[x.length-1].text===y?x[x.length-1].domain.push(f):x.push({text:y,domain:[f]})})}),p.reverse()},i=m=>{let p=e.size.width,f=Math.max(...m.map(h=>h.text?h.text.length:0));return t==="horizontal"?m&&m.length*16>p-100?{size:f*5+10,rotation:90}:m&&m.length*(f*6+10)>p-100?{size:f*3+20,rotation:45}:{size:25,rotation:0}:{size:f*5+10,rotation:0}},c=(m,p)=>{let f=S=>{let _=S.indexOf(",")!==-1?",":" ",k=S.substring(S.indexOf("(")+1,S.indexOf(")")).split(_).map(F=>parseInt(F));for(;k.length<2;)k.push(0);return k},g=p?(S,_)=>S.x+S.width+14>_.x+_.width:(S,_)=>S.x<=_.x+_.width&&_.x<=S.x+S.width&&S.y<=_.y+_.height&&_.y<=S.y+S.height,x=(S,_)=>S.x>=_.x&&S.x+S.width<=_.x+_.width&&S.y>=_.y&&S.y+S.height<=_.y+_.height,b=t=="horizontal"?s(m):null,v=[];m.each((S,_,k)=>{let F=Ze.select(k[_]),G=f(F.attr("transform")),M=F.node().getBBox(),z={x:M.x+G[0],y:M.y+G[1],width:M.width,height:M.height},O=v.some(H=>g(H,z))||b&&!x(z,b);F.attr("visibility",O?"hidden":""),O||v.push(z)})},s=m=>{let p=pe(m.node());if(p===null)return;let f=p.querySelector(".cartesian-chart"),h=f.querySelector(".x-axis"),y=f.getBoundingClientRect(),g=h.getBoundingClientRect();return{x:y.left-g.left,width:y.width,y:y.top-g.top,height:y.height}},u=m=>m?m<60?`rotate(-${m} 5 5)`:`rotate(-${m} 3 7)`:"translate(0, 8)",d=(m,p)=>{let f=u(p),h=p?"end":"";m.each((y,g,x)=>{Ze.select(x[g]).select("text").attr("transform",f).style("text-anchor",h)})};return n.orient=(...m)=>m.length?(t=m[0],n):t,n.settingName=(...m)=>m.length?(r=m[0],n):r,n.domain=(...m)=>m.length?(o=m[0],n):o,n};var ea={none:It,ordinal:qt,time:Ut,linear:Wt},A=e=>{let t=null,r="horizontal",o="crossValues",n=null,a=["crossValue"],l=null,i=null,c=["include","paddingStrategy","pad"],s={},u=p=>{let f=De(e).excludeType(t).settingName(o).settingValue(n)(),h=ea[f],y=h.domain().valueNames(a);c.forEach(b=>{s[b]&&y[b]&&y[b](s[b])}),y.orient&&y.orient(r);let g=y(p);l!==null&&(g=l(g)),i&&typeof g[0]=="number"&&(i[0]=g[0]=Math.min(g[0],i[0]),i[1]=g[1]=Math.max(g[1],i[1]));let x=h.component?d(h,g,p):m();return{scale:h.scale(),domain:g,domainFunction:y,labelFunction:h.labelFunction,component:{bottom:x.bottom,left:x.left,top:x.top,right:x.right},size:x.size,decorate:x.decorate,label:e[o].map(b=>b.name).join(", "),tickFormatFunction:h.tickFormatFunction}},d=(p,f,h)=>p.component(e).orient(r).settingName(o).domain(f)(h),m=()=>({bottom:fe.axisBottom,left:fe.axisLeft,top:fe.axisTop,right:fe.axisRight,decorate:()=>{}});return u.memoValue=(...p)=>p.length?(i=p[0],u):i,u.excludeType=(...p)=>p.length?(t=p[0],u):t,u.orient=(...p)=>p.length?(r=p[0],u):r,u.settingName=(...p)=>p.length?(o=p[0],u):o,u.settingValue=(...p)=>p.length?(n=p[0],u):n,u.valueName=(...p)=>p.length?(a=[p[0]],u):a[0],u.valueNames=(...p)=>p.length?(a=p[0],u):a,u.modifyDomain=(...p)=>p.length?(l=p[0],u):l,c.forEach(p=>{u[p]=(...f)=>f.length?(s[p]=f[0],u):s[p]}),u};import*as he from"d3";import*as Ce from"d3fc";var U=(e,t)=>Tr(e,t,(r,o)=>r.svgPlotArea(o),!1),Re=(e,t)=>Tr(e,t,(r,o)=>r.canvasPlotArea(o).svgPlotArea(Ce.seriesSvgPoint()),!0),Tr=(e,t,r,o)=>{let n=null,a=null,l=Ce.chartCartesian({xScale:e.scale,yScale:t.scale,xAxis:e.component,yAxis:t.component}).xDomain(e.domain).xLabel(e.label).xAxisHeight(e.size).xDecorate(e.decorate).xTickFormat(e.tickFormatFunction).yDomain(t.domain).yLabel(t.label).yAxisWidth(t.size).yDecorate(t.decorate).yOrient("left").yTickFormat(t.tickFormatFunction);e.decorate&&l.xDecorate(e.decorate),t.decorate&&l.yDecorate(t.decorate),l.xPaddingInner&&l.xPaddingInner(1),l.xPaddingOuter&&l.xPaddingOuter(.5),l.yPaddingInner&&l.yPaddingInner(1),l.yPaddingOuter&&l.yPaddingOuter(.5),l.axisSplitter=(...c)=>c.length?(n=c[0],l):n,l.altAxis=(...c)=>c.length?(a=c[0],l):a,l.plotArea=function(...c){return c.length==0?o?this.canvasPlotArea():this.svgPlotArea():r(this,...c)};let i=l.decorate();return l.decorate((c,s)=>{let u=c.select("d3fc-svg.plot-area"),d=u.select("svg").node();d.setAttribute("viewBox",`0 0 ${u.node().clientWidth} ${u.node().clientHeight}`),d.setAttribute("preserveAspectRatio","none");for(let m of["x-axis","y-axis"])c.select(`d3fc-svg.${m} svg`).node().setAttribute("preserveAspectRatio","none");if(i(c,s),o){let m=c.select(".svg-plot-area").node(),p=c.select(".canvas-plot-area").node();he.selectAll([m,p]).order()}if(!!n){if(n.haveSplit()){let m=n.altData(),p=Ce.dataJoin("d3fc-svg","y2-axis").key(g=>g),f=Ce.dataJoin("g","y-series").key(g=>g);c.append("div").attr("class","y-label right-label").style("grid-column",5).style("-ms-grid-column",5).style("grid-row",3).style("-ms-grid-row",3).style("width",a.size||"1em").style("display","flex").style("align-items","center").style("justify-content","center").append("span").attr("class","y-label splitter-label").style("transform","rotate(-90deg)");let h=a.scale.domain(a.domain),y=a.component.right(h);if(y.tickFormat(a.tickFormatFunction),a.decorate&&y.decorate(a.decorate),p(c,["right"]).attr("class",g=>`y-axis ${g}-axis`).on("measure",function(g,x){let{width:b,height:v}=g.detail;x==="left"&&he.select(g.currentTarget).select("svg").attr("viewBox",`${-b} 0 ${b} ${v}`).attr("preserveAspectRatio","none"),h.range([v,0])}).on("draw",function(g,x){he.select(g.currentTarget).select("svg").call(y)}),o){let g=x=>{let b=l.plotArea();b.context(x.node().getContext("2d")).xScale(e.scale);let v=[t.scale,h];[s,m].forEach((S,_)=>{b.yScale(v[_]),b(S)})};c.select("d3fc-canvas.plot-area").on("draw",function(x,b){g(he.select(x.currentTarget).select("canvas"))})}else{let g=function(x){let b=l.plotArea();b.xScale(e.scale);let v=[t.scale,h];f(x,[s,m]).each((S,_,k)=>{b.yScale(v[_]),he.select(k[_]).datum(S).call(b)})};c.select("d3fc-svg.plot-area").on("draw",function(x,b){g(he.select(x.currentTarget).select("svg"))})}}n(c)}}),l};import*as ie from"d3fc";import{select as Qt}from"d3";function N(e,t,r){let o=e.select(t);return o.size()>0?o:r()}function ee(e,t,r="right"){if(r==="right"||r==="bottom")return e[r]<t[r];if(r==="left"||r==="top")return e[r]>t[r];throw`Direction being checked for overflow is invalid: ${r}`}function Xt(e,t,r,o=0){let n=e==="x"?"width":"height",a=t[e],l=t[e]+t[n],i=r[e],c=r[e]+r[n],s=i+o>a&&i-o<l,u=c+o>a&&c-o<l,d=i+o<a&&c-o>l;return s||u||d}var Lr=`<ul id="tooltip-values"></ul>
`;import{select as ra}from"d3";var zr={types:{float:{filter_operator:"==",aggregate:"sum",format:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}},string:{filter_operator:"==",aggregate:"count"},integer:{filter_operator:"==",aggregate:"sum",format:{}},boolean:{filter_operator:"==",aggregate:"count"},datetime:{filter_operator:"==",aggregate:"count",format:{dateStyle:"short",timeStyle:"medium"},null_value:-1},date:{filter_operator:"==",aggregate:"count",format:{dateStyle:"short"},null_value:-1}}};function Be(e){let t={};if(Er().types[e]&&Object.assign(t,Er().types[e]),t.type){let r=Be(t.type);return Object.assign(r,t),r}else return t}function Zt(e){return e&&typeof e=="object"&&!Array.isArray(e)}function Jt(e,...t){if(!t.length)return e;let r=t.shift();if(Zt(e)&&Zt(r))for(let o in r)Zt(r[o])?(e[o]||Object.assign(e,{[o]:{}}),Jt(e[o],r[o])):Object.assign(e,{[o]:r[o]});return Jt(e,...t)}function Er(){return globalThis.__PERSPECTIVE_CONFIG__||(globalThis.__PERSPECTIVE_CONFIG__=Jt(zr,globalThis.__TEMPLATE_CONFIG__||{})),globalThis.__PERSPECTIVE_CONFIG__}function le(e,t){switch(e){case"date":case"datetime":return t instanceof Date?t:new Date(parseInt(t)).toLocaleString([],Be(e).format);case"integer":return parseInt(t,10);case"float":return parseFloat(t)}return t}function dt(e,t){return t.crossValues.length===0?[]:e.crossValue.length===0?[]:((e.crossValue.split?e.crossValue.split("|"):[e.crossValue])||[e.key]).map((o,n)=>({name:t.crossValues[n].name,value:le(t.crossValues[n].type,o)}))}function ft(e,t){if(t.splitValues.length===0)return[];let r=[e.mainValue];return e.key?r=e.key.split("|"):e.mainValue?.split&&(r=e.mainValue.split("|")),t.splitValues.map((o,n)=>({name:o.name,value:le(o.type,r[n])}))}function ht(e,t){return t.mainValues.length>1?e.mainValues?t.mainValues.map((r,o)=>({name:r.name,value:le(r.type,e.mainValues[o])})):t.mainValues.map(r=>({name:r.name,value:le(r.type,e.row[r.name])})):[{name:t.mainValues[0].name,value:le(t.mainValues[0].type,e.colorValue||e.mainValue-e.baseValue||e.mainValue||e.mainValues)}]}function Or(e,t,r){let o=dt(t,r).concat(ft(t,r)).concat(ht(t,r));na(e,o)}function na(e,t){e.select("#tooltip-values").selectAll("li").data(t).join("li").each(function(r){ra(this).text(`${r.name}: `).append("b").text(oa(r.value))})}var oa=e=>e==null?"-":e.toLocaleString(void 0,{style:"decimal",minimumFractionDigits:Be("float").precision,maximumFractionDigits:Be("float").precision});var Mr=e=>[e.name,"==",e.value],Je=(e,t,r)=>{let o=ht(t,r).map(i=>i.name),n=dt(t,r).map(Mr),a=ft(t,r).map(Mr),l=r.filter.concat(n).concat(a);e.dispatchEvent(new CustomEvent("perspective-click",{bubbles:!0,composed:!0,detail:{column_names:o,config:{filter:l},row:t.row}}))},Nr=()=>{let e=null,t=r=>{let o=r.node();r.on("click",(n,a)=>Je(o,a,e))};return t.settings=(...r)=>r.length?(e=r[0],t):e,t};var ge=()=>{let e=!1,t=null,r=null,o=!1,n=a=>{let l=a.node();if(!l||!l.isConnected){Dr(t);return}let i=Qt(pe(l));t=aa(i);let c=function(u,d){Or(t,d,r);let m=a.nodes(),p=m.indexOf(this);la(i.node(),m[p],t,o),Qt(m[p]).style("opacity","0.7")},s=function(u,d){Dr(t);let m=a.nodes(),p=m.indexOf(this);m&&Qt(m[p]).style("opacity","1")};e?a.each(function(u){return c.call(this,void 0,u)}):(a.on("mouseover",c).on("mouseout",s),Nr().settings(r)(a))};return n.alwaysShow=(...a)=>a.length?(e=a[0],n):e,n.centered=(...a)=>a.length?(o=a[0],n):o,n.settings=(...a)=>a.length?(r=a[0],n):r,n};function aa(e){return N(e,"div.tooltip",()=>e.append("div").attr("class","tooltip").style("z-index",3).style("opacity",0).html(Lr))}function la(e,t,r,o){let n=e.getBoundingClientRect(),a=t.getBoundingClientRect(),l=a.left+a.width/2-n.left,i=a.top-n.top+e.scrollTop;o&&(i=a.top+a.height/2-n.top+e.scrollTop),r.style("left",`${l}px`).style("top",`${i}px`).style("opacity",.9),o&&([l,i]=ia(r,n)),sa(r,n,l,i,o)}function ia(e,t){let r=e.node().getBoundingClientRect(),o=r.width/2,n=r.left-o-t.left;e.style("left",`${n}px`);let a=r.height/2,l=r.top-a-t.top;return e.style("top",`${l}px`),[n,l]}function sa(e,t,r,o,n=!1){let a=e.node().getBoundingClientRect();if(ee(t,a)){let l=a.right-t.right;e.style("left",`${r-l}px`)}if(ee(t,a,"bottom")){let l=a.bottom-t.bottom;e.style("top",`${o-l}px`)}if(!!n){if(ee(t,a,"left")){let l=a.left-t.left;e.style("left",`${r-l}px`)}if(ee(t,a,"top")){let l=a.top-t.top;e.style("top",`${o-l}px`)}}}function Dr(e){e&&e.style("opacity",0)}function gt(e,t){let r=e.mainValues.length>1?ie.seriesSvgGrouped(ie.seriesSvgBar()):ie.seriesSvgBar();return r=r.decorate(o=>{ge().settings(e)(o),o.style("fill",n=>t(n.key))}),ie.autoBandwidth(ca(r)).crossValue(o=>o.crossValue).mainValue(o=>o.mainValue?o.mainValue:0).baseValue(o=>o.baseValue)}var ca=e=>{let t=r=>e(r);return ie.rebindAll(t,e),t.bandwidth=(...r)=>r.length?(e.bandwidth(Math.max(r[0],1)),t):e.bandwidth(),t};import*as xt from"d3";function ye(e){return e.split("|").slice(0,-1).join("|")}function yt(e,t){return e.data.map(r=>Object.entries(r).filter(([o,n])=>o.split("|").at(-1)===t&&!!n).map(([o,n])=>n)).flat()}function te(e){let t=e.data&&e.data.length>0?e.data[0]:{},r=Object.keys(t).filter(o=>o!=="__ROW_PATH__");return Z().settings(e).domain(r)()}function Pr(e,t){let r=yt(e,t),o=[...new Set(r)].sort();return Z().settings(e).domain(o)()}function Ae(e,t){let r=[...new Set(t)];return Z().settings(e).domain(r)()}function Fr(e){let t=e.data[0]??{},r=Object.keys(t).filter(n=>n!=="__ROW_PATH__").map(n=>ye(n)),o=[...new Set(r)];return Z().settings(e).domain(o)()}function Z(){let e=null,t=null,r={},o=a=>ke(a,r.colorStyles&&r.colorStyles.opacity),n=()=>{let a=r.colorStyles,l=t||[a.series];if(l||e.length>1){let i=e.length>1?a.scheme:l;return xt.scaleOrdinal(i.map(o)).domain(e)}return null};return n.domain=(...a)=>a.length?(e=a[0],n):e,n.defaultColors=(...a)=>a.length?(t=a[0],n):t,n.mapFunction=(...a)=>a.length?(o=a[0],n):o,n.settings=(...a)=>a.length?(r=a[0],n):r,n}function re(e){return Te(1)(e)}function ke(e,t=.5){return Te(t)(e)}function Te(e){return t=>{let r=xt.color(t);return r!=null&&(r.opacity=e),r+""}}import{rebindAll as ua}from"d3fc";var ma={none:$t,ordinal:Kt,time:Yt,linear:Gt},K=e=>{let t=De(e),r="__ROW_PATH__",o=(n,a)=>ma[t()](r)(n,a);return ua(o,t),o.valueName=(...n)=>n.length?(r=n[0],o):r,o};function Le(e,t,{stack:r=!1,excludeEmpty:o=!1}={}){let n=t||e.data;return e.splitValues.length>0?pa(e,n,{stack:r,excludeEmpty:o}):[n]}function pa(e,t,{stack:r=!1,excludeEmpty:o=!1}){let n={};return t.forEach(a=>{let l={},i={};Object.keys(a).filter(c=>c!=="__ROW_PATH__").filter(c=>!o||a[c]!=null&&a[c]!=null).forEach(c=>{let s=c.split("|"),u=s[s.length-1],d=a[c]||0,m=`${u}${d>=0?"+ve":"-ve"}`,p=s.slice(0,s.length-1).join("|"),f=i[p]=i[p]||{__ROW_PATH__:a.__ROW_PATH__},h=l[m]||0;f.__KEY__=p,r?(f[u]=h+d,f[`__BASE_VALUE__${u}`]=h,l[m]=f[u]):f[u]=d,f.row=a}),Object.keys(i).forEach(c=>{(n[c]=n[c]||[]).push(i[c])})}),Object.keys(n).map(a=>{let l=n[a];return l.key=a,l})}function Rr(e,t){let r={stack:!1},o=Le(e,t,r).map(n=>Br(e,n,r));return e.mainValues.length>1?o.reduce((a,l)=>a.concat(l)):o}function bt(e,t){let r={stack:!0};return Le(e,t,r).map(o=>Br(e,o,r))}function da(e,t,{stack:r=!1}){let o=K(e);return n=>{let a=i=>r&&i[`__BASE_VALUE__${n.name}`]||0,l=t.map((i,c)=>({crossValue:o(i,c),mainValue:i[n.name]?i[n.name]:null,baseValue:a(i),key:i.__KEY__?`${i.__KEY__}|${n.name}`:n.name,row:i.row||i}));return l.key=l[0].key,l}}function Br(e,t,{stack:r=!1}){let o=da(e,t,{stack:r});return e.mainValues.length>1?e.mainValues.map(o):o(e.mainValues[0])}import*as vt from"d3";import*as wt from"d3-svg-legend";import*as Zr from"d3-svg-legend";import{rebindAll as Va}from"d3fc";var $r=`<span id="up-arrow">&#9650;</span>
<span id="page-text"></span>
<span id="down-arrow">&#9660;</span>
`;function Ir(e){let t=e.select("g.legendCells"),r=e.node().getBoundingClientRect();if(!ee(r,t.node().getBoundingClientRect()))return;let o=e.select(".legend");t.selectAll(".label").text((n,a,l)=>{let i=l[a];if(ee(r,i.getBoundingClientRect())){let c=ha(i,o,r);return`${n.substring(0,c-3)}...`}else return n})}function ha(e,t,r){let o=e.getBoundingClientRect(),n=t.node().createSVGPoint(),a=3;return n.x=r.right-o.left-a,n.y=0,e.getCharNumAtPosition(n)}import*as Ee from"d3";import*as Hr from"d3";var ze=10;function xe(e,t,r){let o=Hr.select(Pe(e).getContainer()).node().getBoundingClientRect(),n=e.getBoundingClientRect(),a={top:n.top+r-ze,right:n.right+t+ze,bottom:n.bottom+r+ze,left:n.left+t-ze},l={x:t,y:r};return[{edge:"right",dimension:"x"},{edge:"left",dimension:"x"},{edge:"top",dimension:"y"},{edge:"bottom",dimension:"y"}].forEach(c=>{if(ee(o,a,c.edge)){let s=a[c.edge]-o[c.edge];l[c.dimension]=l[c.dimension]-s}}),l}var er="resize.for-dragging";function jr(){let e=!0,t=null,r=o=>{let n=o.node(),a=n.getRootNode().host.closest("perspective-viewer");n.style.cursor="move",t.legend&&(n.style.left=t.legend.left,n.style.top=t.legend.top);let l=Ee.drag().on("drag",function(i){let c=xe(this,i.dx,i.dy);this.style.left=`${this.offsetLeft+c.x}px`,this.style.top=`${this.offsetTop+c.y}px`;let s={left:this.style.left,top:this.style.top};t.legend={...t.legend,...s},e=xa(n)?ya(n):ga(n,e)});l.on("end",function(i){Ee.select(window).on(er,null),a?.dispatchEvent(new Event("perspective-config-update"))}),o.call(l)};return r.settings=(...o)=>o.length?(t=o[0],r):t,r}function ga(e,t){return t!==!1&&Ee.select(window).on(er,function(){let r=xe(e,0,0);e.style.left=`${e.offsetLeft+r.x}px`,e.style.top=`${e.offsetTop+r.y}px`}),!1}function ya(e){return Ee.select(window).on(er,null),e.style.left="auto",!0}function xa(e){let t=e.getBoundingClientRect(),r=Ee.select(pe(e)).node().getBoundingClientRect(),o=5;return t.right+ze+o>=r.right&&t.top-ze-o<=r.top}import*as Qe from"d3";var Gr="horizontal-drag-handle",Wr="vertical-drag-handle",ba="corner-drag-handle",Ur="dragHandles",Yr=0,be="resize";function Kr(){let e=9,t=3,r=null,o={height:100,width:100},n={height:null,width:null},a=[],l=(u,d)=>a.filter(m=>m.event===u).forEach(m=>m.execute(d)),i=u=>{if(wa(u))return;let d={left:w=>l(be,{horizontal:J(w),vertical:!1}),top:w=>l(be,{horizontal:!1,vertical:oe(w)}),right:w=>l(be,{horizontal:X(w),vertical:!1}),bottom:w=>l(be,{horizontal:!1,vertical:V(w)}),topleft:w=>l(be,{horizontal:J(w),vertical:oe(w)}),topright:w=>l(be,{horizontal:X(w),vertical:oe(w)}),bottomright:w=>l(be,{horizontal:X(w),vertical:V(w)}),bottomleft:w=>l(be,{horizontal:J(w),vertical:V(w)})},m=u.node();r.legend&&(m.style.height=r.legend.height,m.style.width=r.legend.width);let p=m.getBoundingClientRect(),f=u.append("svg").attr("id",Ur).attr("width",p.width).attr("height",p.height),h=f.append("g"),y=w=>w==="left"||w==="right",g={left:0,top:e,right:p.width-e,bottom:e},x={left:e,top:0,right:e,bottom:p.height-e},b=["left","top","right","bottom"],[v,S,_,k]=b.map(w=>h.append("rect").attr("id",`drag${w}`).attr("class",y(w)?Wr:Gr).attr("y",x[w]).attr("x",g[w]).attr("height",y(w)?p.height-e*2:e).attr("width",y(w)?e:p.width-e*2).attr("fill",y(w)?"lightgreen":"lightblue").attr("fill-opacity",Yr).style("z-index",t).attr("cursor",y(w)?"ew-resize":"ns-resize").call(Qe.drag().on("drag",d[w]))),F=w=>`${w[0]}${w[1]}`,G={topleft:"nwse",topright:"nesw",bottomright:"nwse",bottomleft:"nesw"},M=[["top","left"],["top","right"],["bottom","right"],["bottom","left"]],[z,R,O,H]=M.map(w=>h.append("rect").attr("id",`drag${F(w)}`).attr("class",`${ba} ${w[0]} ${w[1]}`).attr("height",e).attr("width",e).attr("fill","red").attr("fill-opacity",Yr).style("z-index",t).attr("cursor",`${G[F(w)]}-resize`).call(Qe.drag().on("drag",d[F(w)])));qe("height","y",k),qe("width","x",_),ce(f);function J(w){let E=s(xe(v.node(),w.x,0).x,f,"width",(W,ae)=>W-ae);return m.style.left=`${m.offsetLeft+E}px`,m.style.width=`${m.offsetWidth-E}px`,T(),Y(_,E,"width","x")}function X(w){let E=-s(xe(_.node(),w.dx,0).x,f,"width",(W,ae)=>W+ae);return c(E,"x",_,w)?!1:(m.style.width=`${m.offsetWidth-E}px`,T(),Y(_,E,"width","x"))}function oe(w){let E=s(xe(S.node(),0,w.y).y,f,"height",(W,ae)=>W-ae);return m.style.top=`${m.offsetTop+E}px`,m.style.height=`${m.offsetHeight-E}px`,T(),Y(k,E,"height","y")}function V(w){let E=-s(xe(k.node(),0,w.dy).y,f,"height",(W,ae)=>W+ae);return c(E,"y",k,w)?!1:(m.style.height=`${m.offsetHeight-E}px`,T(),Y(k,E,"height","y"))}function T(){let w={top:m.style.top,left:m.style.left,height:m.style.height,width:m.style.width};r.legend={...r.legend,...w}}function Y(w,E,W,ae){return _a(f,W,E),Sa(w,ae,E),va(f,E,W,W==="height"?Wr:Gr),ce(f),E!=0}function ce(w){z.attr("y",0,"x",0),R.attr("y",0).attr("x",w.attr("width")-e),O.attr("y",w.attr("height")-e).attr("x",w.attr("width")-e),H.attr("y",w.attr("height")-e).attr("x",0)}function qe(w,E,W){!!n[w]&&n[w]<p[w]&&(m.style[w]=`${n[w]}px`,Y(W,p[w]-n[w],w,E))}};i.on=(u,d)=>(a.push({event:u,execute:d}),i),i.zIndex=u=>(t=u,i),i.settings=(...u)=>u.length?(r=u[0],i):r,i.minWidth=u=>(o.width=u,n.width&&(n.width=Math.max(o.width,n.width)),i),i.minHeight=u=>(o.height=u,n.height&&(n.height=Math.max(o.height,n.height)),i),i.handleWidth=u=>(e=u,i),i.maxWidth=u=>(n.width=u,o.width=Math.min(o.width,n.width),i),i.maxHeight=u=>(n.height=u,o.height=Math.min(o.height,n.height),i);function c(u,d,m,p){let f=(y,g,x,b)=>y<0&&b[g]<Number(x.attr(g)),h=(y,g,x,b)=>y>0&&b[g]>Number(x.attr(g));return f(u,d,m,p)||h(u,d,m,p)}function s(u,d,m,p){let f=p(Number(d.attr(m)),u);if(f<o[m]){let h=o[m]-f;return p(u,h)}if(!!n[m]&&f>n[m]){let h=n[m]-f;return p(u,h)}return u}return i}var va=(e,t,r,o)=>{e.selectAll(`.${o}`).each((a,l,i)=>{let c=i[l];Qe.select(c).attr(r,c.getBoundingClientRect()[r]-t)})},wa=e=>e.select(`#${Ur}`).size()>0,Sa=(e,t,r)=>e.attr(t,Number(e.attr(t))-r),_a=(e,t,r)=>e.attr(t,e.node().getBoundingClientRect()[t]-r);var qr=16,Xr=20,tr=(e,t)=>{let r=e||Zr.legendColor(),o=[],n=1,a,l=t.legend&&t.legend.pageIndex?t.legend.pageIndex:0,i=()=>{},c=jr().settings(t),s,u=v=>{o=r.scale().domain(),s=Kr().settings(t).maxHeight(o.length*qr+Xr).on("resize",()=>d(v)),s(v),c(v),d(v)},d=v=>{y(v),m(v),p(v),Ir(v)},m=v=>{let S=x(v);S.style("display",n<=1?"none":"block"),S.select("#page-text").text(`${l+1}/${n}`),S.select("#up-arrow").attr("class",l===0?"disabled":"").on("click",()=>{l>0&&(f(l-1),d(v))}),S.select("#down-arrow").attr("class",l>=n-1?"disabled":"").on("click",()=>{l<n-1&&(f(l+1),d(v))})},p=v=>{n>1&&r.cellFilter(h()),v.select("g.legendCells").remove();let S=b(v);S.call(r);let _=v.select("g.legendCells").node().getBBox();S.attr("height",_.height+Xr),i(v)},f=v=>{l=v,t.legend={...t.legend,pageIndex:l}},h=()=>(v,S)=>S>=a*l&&S<a*l+a,y=v=>{let S=v.node().getBoundingClientRect(),_=Math.floor(S.height/qr)-1;a=_<o.length?_-1:_,n=g(_),l=Math.min(l,n-1)},g=v=>Math.ceil(o.length/v),x=v=>N(v,".legend-controls",()=>v.append("g").attr("class","legend-controls").html($r)),b=v=>N(v,".legend",()=>v.append("svg").attr("class","legend"));return u.decorate=(...v)=>v.length?(i=v[0],u):i,Va(u,r),u};var Jr=e=>tr(wt.legendColor().shape("circle").shapeRadius(6),e),Ca=e=>tr(wt.legendSymbol().shapePadding(1).labelOffset(3),e),B=()=>rr(Jr),et=()=>rr(Ca,en),Qr=()=>rr(Jr,en);function en(e){if(!e)return null;let t=e.domain(),r=e.range().map(o=>vt.symbol().type(o)());return vt.scaleOrdinal().domain(t).range(r)}function rr(e,t){let r={},o=null,n=null;function a(l){if(o&&o.range().length>1){let i=e(r);i.scale(o).orient("vertical").on("cellclick",function(s){let u=this.__data__;r.hideKeys=r.hideKeys||[],r.hideKeys.includes(u)?r.hideKeys=r.hideKeys.filter(d=>d!==u):r.hideKeys.push(u),Pe(this)._draw()}),i.labels(s=>{let u=String(s.domain[s.i]).split("|");return r.mainValues.length<=1&&u.length>1?u.slice(0,u.length-1).join("|"):s.domain[s.i]});let c=N(l,"div.legend-container",()=>l.append("div"));i.decorate(s=>{let u=m=>r.hideKeys&&r.hideKeys.includes(m),d=s.select("g.legendCells").attr("transform","translate(20,20)").selectAll("g.cell");d.classed("hidden",u),d.append("title").html(m=>m),n&&d.select("circle, path").style("fill",m=>u(m)?null:n(m)).style("stroke",m=>u(m)?null:re(n(m)))}),c.attr("class","legend-container").attr("borderbox-on-hover",!0).style("z-index","2").call(i)}}return a.settings=(...l)=>l.length?(r=l[0],a):r,a.scale=(...l)=>l.length?(o=t?t(l[0]):l[0],a):o,a.color=(...l)=>l.length?(n=l[0],a):n,a}function q(e,t){let r=t||e.data;return(e.hideKeys?.length??0)>0?r.map(n=>{let a={...n};return e.hideKeys.forEach(l=>{delete a[l]}),a}):r}function $e(e,t){let r=t||e.data,o=e.hideKeys?.length??0,n=e.splitValues.length;return o>0?n===0?r.filter(a=>Object.values(a).reduce((l,i)=>l&&!e.hideKeys.includes(i),!0)):r.map(a=>{let l=Object.entries(a).filter(([i,c])=>!e.hideKeys.includes(ye(i)));return Object.fromEntries(l)}):r}import*as ve from"d3fc";var Aa=e=>t=>t.style("stroke-width","1.0").style("stroke",e?e.colorStyles.grid.gridLineColor:"#bbb"),ka=e=>t=>{t.strokeStyle=e?e.colorStyles.grid.gridLineColor:"#bbb",t.lineWidth=1},Ta=e=>e.style("display","none"),La=e=>t=>{t.lineWidth=1,t.strokeStyle=e?e.colorStyles.grid.gridLineColor:"#bbb"},D=(e,t)=>{let r="both",o=!1,n=null,a=null,l=null,i=ve.seriesSvgMulti(),c=ve.annotationSvgGridline(),s=Aa(t),u=Ta,d=function(...m){o&&(i=ve.seriesCanvasMulti().context(l),c=ve.annotationCanvasGridline(),s=ka(t),u=La(t));let p=i.xScale(n).yScale(a),f=r==="vertical"?u:s,h=r==="horizontal"?u:s,y=c.xDecorate(f).yDecorate(h);return p.series([y,e])(...m)};return d.orient=(...m)=>m.length?(r=m[0],d):r,d.canvas=(...m)=>m.length?(o=m[0],d):o,d.xScale=(...m)=>m.length?(n=m[0],d):n,d.yScale=(...m)=>m.length?(a=m[0],d):a,d.context=(...m)=>m.length?(l=m[0],d):l,d};import*as tn from"d3fc";var $=()=>{let e=ct(),t=r=>{let o=e.pad(),n=e.padUnit(),a=1;switch(n){case"domain":break;case"percent":{a=r[1]-r[0];break}default:throw new Error("Unknown padUnit: "+n)}let l=r[0]-o[0]*a,i=r[1]+o[1]*a;return r[0]=r[0]>=0&&l<0?0:l,r[1]=r[1]<=0&&i>0?0:i,r};return tn.rebindAll(t,e),t};import*as Ie from"d3";var rn=`<button id="zoom-reset">Reset zoom</button>
<button id="one-year">1 Year</button>
<button id="six-months">6 Months</button>
<button id="one-month">1 Month</button>
`;var P=()=>{let e=null,t=null,r=null,o=null,n=null,a=null,l=!1,i=!1,c=()=>{};function s(p){let f=`d3fc-${i?"canvas":"svg"}.plot-area`;if(r||n){let h=o&&o.domain()[0]instanceof Date,y=Ie.zoom().on("zoom",x=>{let{transform:b}=x;t.zoom={k:b.k,x:b.x,y:b.y},u(b),p.call(e);let v=b.k===1&&b.x===0&&b.y===0,S=d(p).style("display",v?"none":"");S.select("#zoom-reset").on("click",()=>p.select(f).call(y.transform,Ie.zoomIdentity));let _=S.select("#one-year").style("display",h?"":"none"),k=S.select("#six-months").style("display",h?"":"none"),F=S.select("#one-month").style("display",h?"":"none");if(h){let G=M=>()=>{let z=new Date(r.domain()[0]),R=new Date(z);M(z,R);let O=o.range(),H=(O[1]-O[0])/(o(R)-o(z)),J=-o(z)*H,X=0;if(n){let oe=n.domain().reduce((V,T)=>V+T)/2;X=-a(oe)*H+n(oe)}p.select(f).call(y.transform,Ie.zoomIdentity.translate(J,X).scale(H))};_.on("click",G((M,z)=>z.setYear(M.getFullYear()+1))),k.on("click",G((M,z)=>z.setMonth(M.getMonth()+6))),F.on("click",G((M,z)=>z.setMonth(M.getMonth()+1)))}}),g=e.decorate();e.decorate((x,b)=>{if(g(x,b),!l){l=!0;let v=x.select(f),S=i?window.devicePixelRatio:1;v.on("measure.zoom-range",_=>{if(o&&o.range([0,_.detail.width/S]),a&&a.range([0,_.detail.height/S]),t.zoom){let k=Ie.zoomIdentity.translate(t.zoom.x,t.zoom.y).scale(t.zoom.k);v.call(y.transform,k)}}).call(y)}})}p.call(e)}s.chart=(...p)=>p.length?(e=p[0],s):e,s.settings=(...p)=>p.length?(t=p[0],s):t,s.xScale=(...p)=>p.length?(r=m(p[0]),o=r?r.copy():null,s):r,s.yScale=(...p)=>{if(!p.length)return n;if(n=m(p[0]),a=n?n.copy():null,a){let f=a.domain();a.domain([f[1],f[0]])}return s},s.canvas=(...p)=>p.length?(i=p[0],s):i,s.onChange=(...p)=>p.length?(c=p[0],s):c;let u=p=>{let f={...p};if(r&&(r.domain(p.rescaleX(o).domain()),f.xDomain=r.domain()),n){let h=p.rescaleY(a).domain();n.domain([h[1],h[0]]),f.yDomain=n.domain()}c(f)},d=p=>N(p,".zoom-controls",()=>p.append("div").attr("class","zoom-controls").style("display","none").html(rn)),m=p=>p&&p.nice?p:null;return s};function on(e,t){let r=bt(t,q(t)),o=te(t),n=B().settings(t).scale(o),a=gt(t,o).orient("horizontal"),l=nn.seriesSvgMulti().mapping((d,m)=>d[m]).series(r.map(()=>a)),i=A(t).settingName("mainValues").valueName("mainValue").memoValue(t.axisMemo[0]).excludeType(C.ordinal).include([0]).paddingStrategy($())(r),c=A(t).excludeType(C.linear).settingName("crossValues").valueName("crossValue").orient("vertical")(r),s=U(i,c).plotArea(D(l,t).orient("horizontal"));s.yPaddingInner&&(s.yPaddingInner(.5),s.yPaddingOuter(.25),a.align("left")),s.xNice&&s.xNice();let u=P().chart(s).settings(t).yScale(c.scale);e.datum(r).call(u),e.call(n)}on.plugin={name:"X Bar",category:"X Chart",max_cells:1e3,max_columns:50,render_warning:!0,initial:{names:["X Axis"]}};var an=on;import*as fn from"d3fc";var un=(e,t)=>{if(!ln(e)||!ln(t))return;let r=sn(e),o=sn(t);r>o?t[0]=cn(t,r):e[0]=cn(e,o)},ln=e=>e.length===2&&!isNaN(e[0])&&!isNaN(e[1])&&e[0]!==e[1],sn=e=>(0-e[0])/(e[1]-e[0]),cn=(e,t)=>t*e[1]/(t-1);import*as mn from"d3fc";var pn=e=>{let t=[],r=!1,o,n=l=>{l.text("");let i=mn.dataJoin("span","splitter-label").key(u=>u),c=!r&&t.length===1,s=o&&e.splitValues.length===0;i(l,t).classed("disabled",c).text(u=>u.name).style("color",u=>s?re(o(u.name)):void 0).on("click",(u,d)=>{c||(r?e.splitMainValues=e.splitMainValues.filter(m=>m!=d.name):e.splitMainValues=[d.name].concat(e.splitMainValues||[]),u.target.getRootNode().host.closest("perspective-viewer")?.dispatchEvent(new Event("perspective-config-update")),a(l))})},a=l=>{let i=Pe(l.node());i._container.innerHTML="",i._draw()};return n.labels=(...l)=>l.length?(t=l[0],n):t,n.alt=(...l)=>l.length?(r=l[0],n):r,n.color=(...l)=>l.length?(o=l[0],n):o,n};var we=(e,t,r=Ea)=>{let o,n,a,l=e.splitMainValues||[],i=u=>{let d=u.split("|");return l.includes(d[d.length-1])},c=e.mainValues.some(u=>i(u.name));n=c?r(t,u=>!i(u)):t,a=c?r(t,i):null;let s=u=>{if(e.mainValues.length===1)return;let d=e.mainValues.map((h,y)=>({index:y,name:h.name})),m=d.filter(h=>!i(h.name)),p=d.filter(h=>i(h.name)),f=()=>pn(e).color(o);u.select(".y-label.left-label").call(f().labels(m)),u.select(".y-label.right-label").call(f().labels(p).alt(!0))};return s.color=(...u)=>u.length?(o=u[0],s):o,s.haveSplit=()=>c,s.data=(...u)=>u.length?(n=u[0],s):n,s.altData=(...u)=>u.length?(a=u[0],s):a,s},Ea=(e,t)=>e.map(r=>r.filter(o=>t(o.key))),nr=(e,t)=>e.map(r=>t(r.key)?r:r.map(o=>Object.assign({},o,{mainValue:null}))),dn=(e,t)=>e.map(r=>nr(r,t));function hn(e,t){let r=bt(t,q(t)),o=te(t),n=B().settings(t).scale(o),a=gt(t,o).orient("vertical"),l=fn.seriesSvgMulti().mapping((h,y)=>h[y]).series(r.map(()=>a)),i=A(t).excludeType(C.linear).settingName("crossValues").valueName("crossValue")(r),c=A(t).settingName("mainValues").valueName("mainValue").memoValue(t.axisMemo[1]).excludeType(C.ordinal).orient("vertical").include([0]).paddingStrategy($()),s=t.mainValues.length>1?dn:nr,u=we(t,r,s).color(o),d=c(u.data()),m=u.haveSplit()?l:D(l,t).orient("vertical"),p=U(i,d).axisSplitter(u).plotArea(m);p.xPaddingInner&&(p.xPaddingInner(.5),p.xPaddingOuter(.25),a.align("left")),p.yNice&&p.yNice();let f=P().chart(p).settings(t).xScale(i.scale);if(u.haveSplit()){let h=c(u.altData());un(d.domain,h.domain),p.yDomain(d.domain).altAxis(h)}e.datum(u.data()).call(f),e.call(n)}hn.plugin={name:"Y Bar",category:"Y Chart",max_cells:1e3,max_columns:50,render_warning:!0,initial:{names:["Y Axis"]}};var gn=hn;import*as bn from"d3fc";import*as yn from"d3fc";function He(e,t){let r=yn.seriesSvgLine(),o=e.data.length*(e.data?.length>0?Object.keys(e.data[0]).length-(e.crossValues?.length>0?1:0):0),n=Math.max(1,Math.min(3,Math.floor(e.size.width/o/2)));return r=r.decorate(a=>{a.style("stroke",l=>re(t(l[0]&&l[0].key))).style("stroke-width",n)}),r.crossValue(a=>a.crossValue).mainValue(a=>a.mainValue)}function xn(e,t){let r=K(e);return t.map((o,n)=>Object.keys(o).filter(a=>a!=="__ROW_PATH__").map(a=>({key:a,crossValue:r(o,n),mainValue:o[a],row:o})))}var St=function(e){let t=[];for(let r of e)for(let o=0;o<r.length;o++)r[o].mainValue!==null&&(t[o]=t[o]||[],t[o].push(r[o]));return t};import*as _t from"d3fc";var or=(e,t,r=Math.min)=>{let o=l=>l.reduce((i,c)=>{let s=n(c,t);return s&&(!i||r(i.value,s.value)===s.value)?s:i},null),n=l=>{if(Array.isArray(l))return o(l,t);let i=t(l);return i!==null?{item:l,value:i}:null},a=o(e,t);return a?a.item:null};var j=()=>{let e=ge().alwaysShow(!0),t=null,r=null,o=null,n=null,a=!1,l=null,i="crossValue",c="mainValue",s=null,u=1;function d(f){let h=`d3fc-${a?"canvas":"svg"}.plot-area`;if(t||r){let y=null,g=_t.pointer().on("point",x=>{let b=x.length?p(x[0]):null;y=b?[b.data]:[];let v=b?b.scale:r;m(f,y,v)});f.select(h).on("measure.nearbyTip",()=>m(f,[])).on("click",()=>{y.length&&Je(f.node(),y[0],e.settings())}).call(g)}}let m=(f,h,y=r)=>{let g=f.select("d3fc-svg.plot-area svg").selectAll("circle.nearbyTip").data(h);g.exit().remove(),g.enter().append("circle").attr("class","nearbyTip").merge(g).attr("r",x=>n?u*Math.sqrt(n(x.size)):10).attr("transform",x=>`translate(${t(x[i])},${y(x[c])})`).style("stroke","none").style("fill",x=>o&&x.key&&ke(o(x.key))),e(g)},p=f=>{let h=x=>b=>b[c]===void 0||b[c]===null||b[i]===void 0||b[i]===null?null:Math.sqrt(Math.pow(t(b[i])-f.x,2)+Math.pow(x(b[c])-f.y,2)),y=h(r),g=or(l,y,Math.min);if(s){let x=h(s.yScale),b=or(s.data,x,Math.min);return y(g)<=x(b)?{data:g,scale:r}:{data:b,scale:s.yScale}}return{data:g,scale:r}};return d.scaleFactor=(...f)=>f.length?(u=f[0],d):u,d.xScale=(...f)=>f.length?(t=f[0],d):t,d.yScale=(...f)=>f.length?(r=f[0],d):r,d.color=(...f)=>f.length?(o=f[0],d):o,d.size=(...f)=>f.length?(n=f[0]?f[0].copy().range([40,4e3]):null,d):n,d.canvas=(...f)=>f.length?(a=f[0],d):a,d.data=(...f)=>f.length?(l=f[0],d):l,d.xValueName=(...f)=>f.length?(i=f[0],d):i,d.yValueName=(...f)=>f.length?(c=f[0],d):c,d.altDataWithScale=(...f)=>f.length?(s=f[0],d):s,_t.rebindAll(d,e),d};function vn(e,t){let r=xn(t,q(t)),o=te(t),n=B().settings(t).scale(o),a=bn.seriesSvgRepeat().series(He(t,o)).orient("horizontal"),l=$().pad([.1,.1]).padUnit("percent"),i=we(t,St(r)).color(o),c=A(t).excludeType(C.linear).settingName("crossValues").valueName("crossValue")(r),s=A(t).settingName("mainValues").valueName("mainValue").memoValue(i.haveSplit()?null:t.axisMemo[0]).orient("vertical").paddingStrategy(l),u=s(i.data()),d=i.haveSplit()?a:D(a,t).orient("vertical"),m=U(c,u).axisSplitter(i).plotArea(d);m.yNice&&m.yNice();let p=P().chart(m).settings(t).xScale(c.scale),f=j().settings(t).xScale(c.scale).yScale(u.scale).color(o).data(r);if(i.haveSplit()){let y=s(i.altData());m.altAxis(y),f.data(i.data()).altDataWithScale({yScale:y.scale,data:i.altData()})}let h=i.data();e.datum(h).call(p),e.call(f),e.call(n)}vn.plugin={name:"Y Line",category:"Y Chart",max_cells:4e3,max_columns:50,render_warning:!0,initial:{names:["Y Axis"]}};var wn=vn;import*as An from"d3fc";import{seriesCanvasPoint as Na}from"d3fc";import*as L from"d3";var ar=Math.sqrt(3),Oa={draw:function(e,t){let r=Math.sqrt(t/(ar*3));e.moveTo(0,r*2),e.lineTo(-ar*r,-r),e.lineTo(ar*r,-r),e.closePath()}},Ma=[L.symbolCircle,L.symbolCross,L.symbolDiamond,L.symbolSquare,L.symbolStar,L.symbolTriangle,L.symbolWye],Vt={circle:L.symbolCircle,square:L.symbolSquare,cross:L.symbolCross,diamond:L.symbolDiamond,star:L.symbolStar,triangle:L.symbolTriangle,wye:L.symbolWye,nabla:Oa};function tt(e){return e.length>1?L.scaleOrdinal().domain(e).range(Ma):null}var Da=8,Pa=1;function Sn(e,t,r,o,n,a,l=1){let i=Na().crossValue(c=>c.x).mainValue(c=>c.y);return a&&i.type(c=>a(c.row[t])),r&&i.size(c=>Math.round(l*r(c.size))),i.decorate((c,s)=>{let u=o(s.colorValue),d=e.colorStyles?.opacity;if(n){let{type:m}=e.mainValues.find(f=>f.name===n),p=le(m,s.row[n]);if(p!==null){c.fillStyle=e.textStyles.color,c.font=e.textStyles.font;let f=0;r&&(f=Math.sqrt(l*r(s.size)/Math.PI)*Pa);let h=f+Da;c.fillText(p,h,4)}}c.strokeStyle=re(u),c.fillStyle=ke(u,d)}),i}function _n(e,t){let r=[...new Set(yt(e,t))];return tt(r)}function Vn(e){let t=e.data&&e.data.length>0?e.data[0]:{},r=[];return Object.keys(t).forEach(o=>{if(o!=="__ROW_PATH__"){let n=ye(o);r.includes(n)||r.push(n)}}),tt(r)}function Cn(e,t){let r=e.mainValues.length;return t.map(o=>{let n=Object.keys(o).filter(l=>l!=="__ROW_PATH__"),a=new Array(n.length/r);for(let l=0;l<n.length/r;l++)a[l]={key:ye(n[l*r]),crossValue:o[n[l*r]],mainValue:o[n[l*r+1]],row:o};return a})}function kn(e,t){let r=St(Cn(t,$e(t))),o=Fr(t),n=Vn(t),a=null;o.domain().length>=2&&(a=Qr().settings(t).scale(n).color(o));let l=An.seriesSvgRepeat().series(He(t,o)).orient("horizontal"),i=$().pad([.1,.1]).padUnit("percent"),c=A(t).settingName("mainValues").settingValue(t.mainValues[0].name).valueName("crossValue").memoValue(t.axisMemo[0]).paddingStrategy(i),u=A(t).settingName("mainValues").settingValue(t.mainValues[1].name).valueName("mainValue").memoValue(t.axisMemo[1]).orient("vertical").paddingStrategy(i)(r),d=c(r),m=D(l,t).orient("vertical"),p=U(d,u).xLabel(t.mainValues[0].name).yLabel(t.mainValues[1].name).plotArea(m);p.xNice&&p.xNice(),p.yNice&&p.yNice();let f=P().chart(p).settings(t).xScale(d.scale).yScale(u.scale),h=j().settings(t).xScale(d.scale).yScale(u.scale).color(o).data(r);e.datum(r).call(f),e.call(h),a&&e.call(a)}kn.plugin={name:"X/Y Line",category:"X/Y Chart",max_cells:5e4,max_columns:50,render_warning:!0,initial:{type:"number",count:2,names:["X Axis","Y Axis","Tooltip"]},selectMode:"toggle"};var Tn=kn;import*as rt from"d3fc";import*as Ln from"d3fc";function zn(e,t){let r=Ln.seriesSvgArea();return r=r.decorate(o=>{o.style("fill",n=>t(n[0].key)).style("opacity",.5)}),r.crossValue(o=>o.crossValue).mainValue(o=>o.mainValue).baseValue(o=>o.baseValue)}function En(e,t){let r=K(e);return t.map((o,n)=>{let a={};return Object.keys(o).filter(l=>l!=="__ROW_PATH__").map(l=>{let i=l.split("|"),c=i[i.length-1],s=a[c]||0,u=s+o[l];return a[c]=u,{key:l,crossValue:r(o,n),mainValue:u,baseValue:s,row:o}})})}function On(e,t){let r=En(t,q(t)),o=te(t),n=B().settings(t).scale(o),a=rt.seriesSvgRepeat().series(zn(t,o).orient("vertical")),l=rt.seriesSvgRepeat().series(He(t,o)).orient("vertical"),i=rt.seriesSvgMulti().series([a,l]),c=A(t).excludeType(C.linear).settingName("crossValues").valueName("crossValue")(r),s=A(t).settingName("mainValues").valueName("mainValue").memoValue(t.axisMemo[1]).excludeType(C.ordinal).orient("vertical").include([0]).paddingStrategy($()),u=we(t,r).color(o),d=s(u.data()),m=u.haveSplit()?i:D(i,t).orient("vertical"),p=U(c,d).axisSplitter(u).plotArea(m);p.yNice&&p.yNice();let f=P().chart(p).settings(t).xScale(c.scale),h=j().settings(t).xScale(c.scale).yScale(d.scale).color(o).data(r);if(u.haveSplit()){let y=s(u.altData());p.altAxis(y),h.data(u.data()).altDataWithScale({yScale:y.scale,data:u.altData()})}e.datum(u.data()).call(f),e.call(h),e.call(n)}On.plugin={name:"Y Area",category:"Y Chart",max_cells:4e3,max_columns:50,render_warning:!0,initial:{names:["Y Axis"]}};var Mn=On;import*as Fn from"d3fc";import*as Nn from"d3fc";function Dn(e,t,r,o){let n=Nn.seriesSvgPoint().size(100),a=e.colorStyles&&e.colorStyles.opacity;return o&&n.type(o(t)),n.decorate(l=>{l.style("stroke",i=>re(r(i.colorValue||t))).style("fill",i=>ke(r(i.colorValue||t),a))}),n.crossValue(l=>l.crossValue).mainValue(l=>l.mainValue)}function Pn(e){let t=e.data&&e.data.length>0?e.data[0]:{},r=Object.keys(t).filter(o=>o!=="__ROW_PATH__");return tt(r)}function Rn(e,t){let r=Rr(t,q(t)),o=Pn(t),n=te(t),a=et().settings(t).scale(o).color(n),l=Fn.seriesSvgMulti().mapping((y,g)=>y[g]).series(r.map(y=>Dn(t,y.key,n,o))),i=$().pad([.05,.05]).padUnit("percent"),c=A(t).excludeType(C.linear).settingName("crossValues").valueName("crossValue")(r),s=A(t).settingName("mainValues").valueName("mainValue").memoValue(t.axisMemo[1]).orient("vertical").paddingStrategy(i),u=we(t,r).color(n),d=s(u.data()),m=u.haveSplit()?l:D(l,t).orient("vertical"),p=U(c,d).axisSplitter(u).plotArea(m);p.yNice&&p.yNice();let f=P().chart(p).settings(t).xScale(c.scale),h=j().settings(t).xScale(c.scale).yScale(d.scale).color(n).data(r);if(u.haveSplit()){let y=s(u.altData());p.altAxis(y),h.data(u.data()).altDataWithScale({yScale:y.scale,data:u.altData()})}e.datum(u.data()).call(f),e.call(h),a&&e.call(a)}Rn.plugin={name:"Y Scatter",category:"Y Chart",max_cells:4e3,max_columns:50,render_warning:!0,initial:{names:["Y Axis"]}};var Bn=Rn;import"d3fc";import{select as Gn}from"d3";function $n(e,t){return Le(e,t,{excludeEmpty:!0}).map(r=>Fa(e,r))}function Fa(e,t){let r=K(e),o=t.map((n,a)=>({crossValue:r(n,a),mainValues:e.mainValues.map(l=>n[l.name]),x:n[e.mainValues[0].name],y:n[e.mainValues[1].name],colorValue:e.realValues[2]?n[e.realValues[2]]:void 0,size:e.realValues[3]?n[e.realValues[3]]:void 0,key:t.key,row:n}));return o.key=t.key,o}import*as je from"d3";function In(e,t,r,o){return je.scaleLinear().domain(Hn(t,r,o))}function Se(e,t,r,o){let n=Hn(t,r,o),a=e.colorStyles.gradient.full;if(n[0]>=0)a=e.colorStyles.gradient.positive;else if(n[1]<=0)a=e.colorStyles.gradient.negative;else{let i=Math.max(-n[0],n[1]);n=[-i,i]}let l=Ra(a);return je.scaleSequential(l).domain(n)}var Hn=(e,t,r)=>r||jt().valueName(t).pad([0,0])(e),Ra=e=>{let t=e.slice(1).map((r,o)=>je.interpolate(e[o][1],r[1]));return r=>{let o=e.findIndex((i,c)=>c<e.length-1&&r<=e[c+1][0]&&r>i[0]);if(o===-1)return r<=e[0][0]?e[0][1]:e[e.length-1][1];let n=t[o],[a]=e[o],[l]=e[o+1];return n((r-a)/(l-a))}};import*as Ge from"d3";import*as _e from"d3fc";function Ve(){let e=null;function t(r){let o=N(r,"div.legend-container",()=>r.append("div").attr("class","legend-container legend-color").style("z-index","2")),{width:n,height:a}=o.node().getBoundingClientRect(),l=Ge.scaleBand().domain([0,1]).range([0,n]),i=e.copy().nice().domain(),c=_e.extentLinear().pad([.1,.1]).padUnit("percent")(i),[s,u]=c,d=Ge.range(s,u,(u-s)/a),m=Ge.scaleLinear().domain(c).range([a,0]),p=_e.autoBandwidth(_e.seriesSvgBar()).xScale(l).yScale(m).crossValue(0).baseValue((v,S)=>d[Math.max(0,S-1)]).mainValue(v=>v).decorate(v=>{v.selectAll("path").style("fill",S=>e(S))}),f=i[0]<0&&i[1]>0?0:Math.round((i[1]+i[0])/2),h=[...i,f],y=_e.axisRight(m).tickValues(h).tickSizeOuter(0).tickFormat(v=>mt(v)),g=N(o,"svg",()=>o.append("svg")).style("width",n).style("height",a),x=N(g,"g",()=>g.append("g")).datum(d).call(p),b=Math.abs(x.node().getBBox().x);N(g,"#legend-axis",()=>g.append("g").attr("id","legend-axis")).attr("transform",`translate(${b})`).datum(d).call(y).select(".domain").attr("visibility","hidden")}return t.scale=(...r)=>r.length?(e=r[0],t):e,t}function We(){let e="element-prefix-unset",t=null,r=null,o=null,n=null,a=null,l=null,i=!0,c=null,s=u=>{let d=N(u,"div.outer-container",()=>u.append("div").attr("class","outer-container").style("width",`calc(100% - ${c??0})`).style("height",`calc(100% - ${c??0})`).style("padding-left",c??0)),m=N(d,"div.inner-container",()=>d.append("div").attr("class","inner-container")),p=d.node().getBoundingClientRect(),f=p.height,h=p.width-(a?70:0),y=300,g=u.datum(),x=Math.max(1,Math.min(g.length,Math.floor(h/y))),b=Math.ceil(g.length/x);l={width:h/Math.max(x,1),height:Math.min(f,Math.max(f/b,h/Math.max(x,1)))},f/b>l.height*.75&&(l.height=f/b),g.length>1?(m.style("grid-template-columns",`repeat(${x}, ${100/x}%)`),m.style("grid-template-rows",`repeat(${b}, ${l.height}px)`)):(m.style("grid-template-columns","repeat(1, 100%)"),m.style("grid-template-rows","repeat(1, 100%)")),o=m.selectAll(`div.${e}-container`).data(g,v=>v.split),o.exit().remove(),r=o.enter().append("div").attr("class",`${e}-container`),n=r.append("div").attr("class","title-container").style("text-align","center").attr("display","inline-block").append("text").attr("class","title").style("text-align","left"),i?t=r.append("svg").append("g").attr("class",e):t=r.append("div").attr("class",e)};return s.padding=(...u)=>u.length?(c=u[0],s):c,s.svg=(...u)=>u.length?(i=u[0],s):i,s.elementsPrefix=(...u)=>u.length?(e=u[0],s):e,s.chartContainer=()=>t,s.chartEnter=()=>r,s.chartDiv=()=>o,s.chartTitle=()=>n,s.containerSize=()=>l,s}import*as jn from"d3fc";function Ba([e,t],[r,o]){let n=(o-t)/(r-e),a=o-n*r;return function(l){let i=l.node(),c=Math.min(i.clientWidth,i.clientHeight);return Math.min(o,Math.max(t,n*c+a))}}function Ct(){let e=null,t=null,r=null,o=null,n=a=>{let i=!!e.realValues[2],c=e.realValues[4],s=e.realValues[3]?In(e,t,"size").range([10,1e4]):null,u=e.realValues[5],d=Ba([600,.1],[1600,1])(a),m=jn.seriesCanvasMulti().mapping((S,_)=>S[_]).series(t.map(S=>Sn(e,c,s,r,u,o,d))),p=()=>A(e).settingName("mainValues").paddingStrategy($()).pad([.1,.1]),f=p().settingValue(e.mainValues[0].name).memoValue(e.axisMemo[0]).valueName("x")(t),h=p().orient("vertical").settingValue(e.mainValues[1].name).memoValue(e.axisMemo[1]).valueName("y")(t),[y,g]=e.splitValues.length===0?[e.mainValues[0].name,e.mainValues[1].name]:["",""],x=Re(f,h).xLabel(y).yLabel(g).plotArea(D(m,e).canvas(!0));x.xNice&&x.xNice(),x.yNice&&x.yNice();let b=P().chart(x).settings(e).xScale(f.scale).yScale(h.scale).canvas(!0),v=j().scaleFactor(d).settings(e).canvas(!0).xScale(f.scale).xValueName("x").yValueName("y").yScale(h.scale).color(!i&&r).size(s).data(t);a.datum(t).call(b),a.call(v)};return n.settings=(...a)=>a.length?(e=a[0],n):e,n.data=(...a)=>a.length?(t=a[0],n):t,n.color=(...a)=>a.length?(r=a[0],n):r,n.symbols=(...a)=>a.length?(o=a[0],n):o,n}function $a(e,t){if(!t)return;let r=e.realValues[4],o=e.mainValues.find(i=>i.name===r)?.type,n=t.domain(),a=t.range(),l=a.length;for(let i in n)a[i]=a[i%l];return e.columns?.[r]?.symbols?.forEach(({key:i,value:c})=>{let s=Vt[c]??d3.symbolCircle,u=n.findIndex(d=>{switch(o){case"date":case"datetime":return Date(d)===Date(i);default:return String(d)===String(i)}});a[u]=s}),t.range(a),t}function Wn(e,t){let r=t.realValues[2],o=!!r,n=t.mainValues.find(u=>u.name===r)?.type==="string",a=null,l=null,i=t.realValues[4],c=$a(t,_n(t,i)),s=$n(t,$e(t));if(o&&n?i?(t.splitValues.length>0?a=Ae(t,s):a=Ae(t,s[0]),l=et().settings(t).scale(c)):(a=Pr(t,r),l=B().settings(t).scale(a)):o?(a=Se(t,s,"colorValue"),l=Ve().scale(a)):(a=Z().settings(t).domain([""])(),l=et().settings(t).scale(c)),t.splitValues.length!==0){let u=We().svg(!1).elementsPrefix("xy-scatter");u=u.padding("2.5em"),e.append("div").attr("class","multi-xlabel").append("p").text(t.mainValues[0].name),e.append("div").attr("class","multi-ylabel").append("p").text(t.mainValues[1].name).style("transform","rotate(-90deg)").style("text-wrap","nowrap"),e=e.datum(s),e.call(u);let p=u.chartContainer(),f=u.chartEnter(),h=u.chartDiv(),y=u.chartTitle(),g=u.containerSize();y.each((x,b,v)=>Gn(v[b]).text(x.key)),f.merge(h).attr("transform",`translate(${g.width/2}, ${g.height/2})`).each(function(x){let b=Gn(this);Ct().settings(t).data([x]).color(a).symbols(c)(b)})}else Ct().settings(t).data(s).color(a).symbols(c)(e);l&&e.call(l)}Wn.plugin={name:"X/Y Scatter",category:"X/Y Chart",max_cells:5e4,max_columns:50,render_warning:!0,initial:{type:"number",count:2,names:["X Axis","Y Axis","Color","Size","Symbol","Label","Tooltip"]},selectMode:"toggle"};var Yn=Wn;import*as At from"d3fc";function Un(e,t){let r=At.seriesCanvasHeatmap();return r.decorate((o,n)=>{o.fillStyle=t(n.colorValue)}),At.autoBandwidth(r).xValue(o=>o.crossValue).yValue(o=>o.mainValue).colorValue(o=>o.colorValue).colorInterpolate(t.interpolator()).widthFraction(1)}function Kn(e,t){let r=K(e),o=De(e).excludeType(C.linear).settingName("splitValues")(),n=[];return t.forEach((a,l)=>{let i=r(a,l);Object.keys(a).filter(c=>c!=="__ROW_PATH__").forEach(c=>{let s=Ia(c);n.push({crossValue:i,mainValue:o===C.time?new Date(s):s,colorValue:a[c],row:a})})}),n}function Ia(e){let t=e.split("|");return t.pop(),t.join("|")}function qn(e,t){let r=Kn(t,q(t)),o=Se(t,r,"colorValue"),n=Un(t,o),a=Ve().scale(o),l=A(t).excludeType(C.linear).settingName("crossValues").valueName("crossValue")(r),i=A(t).excludeType(C.linear).settingName("splitValues").valueName("mainValue").modifyDomain(d=>!isNaN(d[0])?d.reverse():d).orient("vertical")(r),c=Re(l,i).plotArea(D(n,t).canvas(!0));c.xPaddingInner&&(c.xPaddingInner(0),c.xPaddingOuter(0),n.xAlign("right")),c.yPaddingInner&&(c.yPaddingInner(0),c.yPaddingOuter(0),n.yAlign("top"));let s=P().chart(c).settings(t).xScale(l.scale).yScale(i.scale).canvas(!0),u=j().settings(t).canvas(!0).xScale(l.scale).yScale(i.scale).color(o).data(r);e.datum(r).call(s),e.call(a),e.call(u)}qn.plugin={name:"Heatmap",category:"Hierarchial Chart",max_cells:5e4,max_columns:500,render_warning:!0,initial:{names:["Color"]}};var Xn=qn;import{seriesCanvasOhlc as Wa}from"d3fc";import*as kt from"d3fc";function Zn(e,t){return Le(e,t,{excludeEmpty:!0}).map(r=>Ha(e,r))}function Ha(e,t){let r=K(e),o=a=>t[a<t.length-1?a+1:a][e.realValues[0]],n=t.map((a,l)=>{let i=e.realValues[0]?a[e.realValues[0]]:void 0,c=e.realValues[1]?a[e.realValues[1]]:o(l);return{crossValue:r(a,l),mainValues:e.mainValues.map(s=>a[s.name]),openValue:i,closeValue:c,highValue:e.realValues[2]?a[e.realValues[2]]:Math.max(i,c),lowValue:e.realValues[3]?a[e.realValues[3]]:Math.min(i,c),key:t.key,row:a}});return n.key=t.key,n}import*as Ye from"d3fc";var ja=e=>e.closeValue>=e.openValue;function Jn(e,t,r){let o=r.domain(),n=Z().domain(o).settings(e).defaultColors([e.colorStyles["series-2"]]).mapFunction(Te(.5))(),a=Z().settings(e).domain(o)(),l=t().crossValue(s=>s.crossValue).openValue(s=>s.openValue).highValue(s=>s.highValue).lowValue(s=>s.lowValue).closeValue(s=>s.closeValue).decorate((s,u)=>{let d=ja(u)?r(u.key):n(u.key);s.fillStyle=d,s.strokeStyle=d}),i=Ye.seriesCanvasLine().mainValue(s=>s.bollinger.average).crossValue(s=>s.crossValue).decorate((s,u)=>{s.strokeStyle=a(u[0].key)}),c=Ye.seriesCanvasArea().mainValue(s=>s.bollinger.upper).baseValue(s=>s.bollinger.lower).crossValue(s=>s.crossValue).decorate((s,u)=>{s.fillStyle=Te(.25)(a(u[0].key))});return Ye.seriesCanvasMulti().series([c,l,i])}function Ga(e){return function(t,r){let o=Zn(r,$e(r)),n=kt.indicatorBollingerBands().value(g=>g.openValue),a=o.map(g=>{let x=n(g);return g.map((b,v)=>Object.assign({bollinger:x[v]},b))}),l=o.map(g=>g.key).concat(r.hideKeys?r.hideKeys:[]).sort(),i=Z().domain(l).settings(r).mapFunction(Te(1))(),c=B().settings(r).scale(l.length>1?i:null),s=Jn(r,e,i),u=kt.seriesCanvasMulti().mapping((g,x)=>g[x]).series(a.map(()=>s)),d=$().pad([.1,.1]).padUnit("percent"),m=A(r).settingName("crossValues").valueName("crossValue")(a),p=A(r).settingName("mainValues").valueNames(["lowValue","highValue"]).memoValue(r.axisMemo[1]).orient("vertical").paddingStrategy(d)(a),f=Re(m,p).plotArea(D(u,r).orient("vertical").canvas(!0));f.yNice&&f.yNice();let h=P().chart(f).settings(r).xScale(m.scale).onChange(g=>{let x=a.map(b=>b.filter(v=>v.crossValue>=g.xDomain[0]&&v.crossValue<=g.xDomain[1]));f.yDomain(p.domainFunction(x))}).canvas(!0),y=j().settings(r).xScale(m.scale).yScale(p.scale).yValueName("closeValue").color(i).data(a).canvas(!0);t.datum(a).call(h),t.call(y),t.call(c)}}var Tt=Ga;var Qn=Tt(Wa);Qn.plugin={name:"OHLC",category:"Y Chart",max_cells:3500,max_columns:50,render_warning:!0,initial:{type:"number",count:1,names:["Open","Close","High","Low","Tooltip"]},selectMode:"toggle"};var eo=Qn;import{seriesCanvasCandlestick as Ya}from"d3fc";var to=Tt(Ya);to.plugin={name:"Candlestick",category:"Y Chart",max_cells:4e3,max_columns:50,render_warning:!0,initial:{type:"number",count:1,names:["Open","Close","High","Low","Tooltip"]},selectMode:"toggle"};var ro=to;import{select as so}from"d3";function no(e,t){if(e.realValues.length>1&&e.realValues[1]!==null){let r=e.realValues[1];if(e.mainValues.find(o=>o.name===r)?.type==="string"){let o=t.map(n=>n.data).filter(n=>n.height>0).map(n=>oo(n)).reduce((n,a)=>n.concat(a));return Ae(e,o)}else return Se(e,null,null,hr(t.map(o=>o.extents)))}}function oo(e,t=[]){return e.children&&e.children.length>0?e.children.forEach(r=>t.concat(oo(r,t))):e.data.color&&t.push(e.data.color),t}import*as Lt from"d3";function zt(e){let t={},r=e.realValues.map(n=>n===null?null:e.mainValues.find(a=>a.name===n));return e.data.forEach((n,a)=>{let l=n.__ROW_PATH__;Ka(n).forEach(c=>{let s;t[c]||(t[c]=[]),s=t[c],l.forEach((u,d)=>{let m=s.find(p=>p.name===u);if(m||(m={name:u,children:[]},s.push(m)),e.realValues.length>1&&e.realValues[1]!==null){let p=d===l.length-1,f=Ue(p?n:e.agg_paths[a][d+1]||n,e.mainValues[1],c);f!==void 0&&(m.color=f)}if(e.realValues.length>2&&e.realValues[2]!==null){m.tooltip=[];for(let p=2;p<e.realValues.length;++p)m.tooltip.push(Ue(n,r[p],c))}if(d===l.length-1){if(m.name=l.slice(-1)[0],e.crossValues.length===0)m.size=Ue(n,e.mainValues[0],"");else if(l.length===e.crossValues.length){let p=Ue(n,e.mainValues[0],c);m.size=p>0?p:0}}s=m.children})})}),Object.entries(t).map(n=>{let a={name:"root",children:n[1]},l=Lt.hierarchy(a).sum(c=>c.size),i=Lt.partition().size([2*Math.PI,l.height+1])(l);return i.each(c=>{c.current=c,c.mainValues=e.realValues.length===1||e.realValues[1]===null&&e.realValues[2]===null?c.value:[c.value,c.data.color].concat(c.data.tooltip||[]).filter(s=>s!==void 0),c.crossValue=c.ancestors().slice(0,-1).reverse().map(s=>s.data.name),c.key=n[0],c.label=le(e.crossValues[c.depth-1<0?0:c.depth-1]?.type||e.mainValues[0].type,c.data.name)}),{split:n[0],data:i,extents:Ua(e,n)}})}var Ue=(e,t,r)=>r.length?e[`${r}|${t.name}`]:e[t.name];function Ua(e,[t,r]){if(e.realValues.length>1&&e.realValues[1]!==null){let o=Math.min(...e.data.map(a=>Ue(a,e.mainValues[1],t))),n=Math.max(...r.map(a=>a.color));return[o,n]}}function Ka(e){let t=[];return Object.keys(e).forEach(r=>{if(r!=="__ROW_PATH__"){let o=r.split("|").slice(0,-1).join("|");t.includes(o)||t.push(o)}}),t}import{arc as qa}from"d3";var Et=e=>qa().startAngle(t=>t.x0).endAngle(t=>t.x1).padAngle(t=>Math.min((t.x1-t.x0)/2,.005)).padRadius(e).innerRadius(t=>Math.max(1,(t.y0-1)*e)).outerRadius(t=>Math.max((t.y0-1)*e,(t.y1-1)*e-1)),se=e=>e.y0>=1&&e.x1>e.x0;import{select as Xa}from"d3";var nt=e=>e.y1<=3&&e.y0>=1&&(e.y1-e.y0)*(e.x1-e.x0)>.06;function Ot(e,t){let r=(e.x0+e.x1)/2*180/Math.PI,o=(e.y0-1+(e.y1-1))/2*t;return`rotate(${r-90}) translate(${o},0) rotate(${r<180?0:180})`}function ao(e,t){let r=this.getBBox().width;if(r>t){let o=e.label,n=Xa(this);for(;r>t;)o=o.substring(0,o.length-1),n.text(()=>o),r=this.getBBox().width;n.text(()=>`${o.substring(0,o.length-3).replace(/\s+$/,"")}...`)}}import{interpolate as Za}from"d3";var lo=(e,t,r,o,n,a,l,i,c)=>(s,u)=>{c.sunburstLevel[i]=s.data.name,s.parent?(r.datum(s.parent),r.style("cursor","pointer"),o.html(`&#8682; ${s.label}`)):(r.datum(e),r.style("cursor","default"),o.html("")),e.each(m=>m.target={x0:Math.max(0,Math.min(1,(m.x0-s.x0)/(s.x1-s.x0)))*2*Math.PI,x1:Math.max(0,Math.min(1,(m.x1-s.x0)/(s.x1-s.x0)))*2*Math.PI,y0:Math.max(0,m.y0-s.depth),y1:Math.max(0,m.y1-s.depth)});let d=t.transition().duration(u?0:750);n.transition(d).tween("data",m=>{let p=Za(m.current,m.target);return f=>m.current=p(f)}).filter(function(m){return+this.getAttribute("fill-opacity")||se(m.target)}).attr("fill-opacity",m=>se(m.target)?1:0).attr("user-select",m=>se(m.target)?"initial":"none").style("pointer-events",m=>se(m.target)?"initial":"none").attrTween("d",m=>()=>Et(l)(m.current)),a.filter(function(m){return+this.getAttribute("fill-opacity")||nt(m.target)}).transition(d).attr("fill-opacity",m=>+nt(m.target)).attrTween("transform",m=>()=>Ot(m.current,l))};function io(){let e=null,t=null,r=null,o=null,n=null,a=l=>{let i=l.selectAll("g.segment").data(r.descendants().slice(1)),c=i.enter().append("g").attr("class","segment");c.append("path"),c.append("text").attr("class","segment").attr("dy","0.35em");let s=c.merge(i),u=s.select("path").attr("fill-opacity",h=>se(h.current)?1:0).attr("user-select",h=>se(h.current)?"initial":"none").style("pointer-events",h=>se(h.current)?"initial":"none").attr("d",h=>Et(n)(h.current));o&&u.style("fill",h=>o(h.data.color));let d=s.select("text").attr("fill-opacity",h=>+nt(h.current)).attr("transform",h=>Ot(h.current,n)).text(h=>h.label).each(function(h){ao.call(this,h,n)}),m=l.select("text.parent"),p=l.select("circle").attr("r",n).datum(r),f=lo(r,l,p,m,u,d,n,t,e);if(e.sunburstLevel){let h=r.descendants().find(y=>y.data.name===e.sunburstLevel[t]);h&&f(h,!0)}else e.sunburstLevel={};p.on("click",h=>f(h,!1)),u.filter(h=>h.children).style("cursor","pointer").on("click",h=>f(h,!1))};return a.settings=(...l)=>l.length?(e=l[0],a):e,a.split=(...l)=>l.length?(t=l[0],a):t,a.data=(...l)=>l.length?(r=l[0],a):r,a.color=(...l)=>l.length?(o=l[0],a):o,a.radius=(...l)=>l.length?(n=l[0],a):n,a}function co(e,t){let r=zt(t),o=no(t,r),n=We().elementsPrefix("sunburst");if(e.datum(r).call(n),o){let u=t.realValues[1];if(t.mainValues.find(d=>d.name===u)?.type==="string"){let d=B().settings(t).scale(o);e.call(d)}else{let d=Ve().scale(o);e.call(d)}}let a=n.chartContainer(),l=n.chartEnter(),i=n.chartDiv(),c=n.chartTitle(),s=n.containerSize();c.each((u,d,m)=>so(m[d]).text(u.split)),a.append("circle").attr("fill","none").style("pointer-events","all"),a.append("text").attr("class","parent"),l.merge(i).select("svg").select("g.sunburst").attr("transform",`translate(${s.width/2}, ${s.height/2})`).each(function({split:u,data:d}){let m=so(this),p=this.parentNode,{width:f,height:h}=p.getBoundingClientRect(),y=(Math.min(f,h)-24)/Math.max(2,t.crossValues.length*2);io().settings(t).split(u).data(d).color(o).radius(y)(m),ge().settings(t)(m.selectAll("g.segment"))})}co.plugin={name:"Sunburst",category:"Hierarchial Chart",max_cells:7500,max_columns:50,render_warning:!0,initial:{type:"number",count:1,names:["Size","Color","Tooltip"]}};var uo=co;import*as lt from"d3";function mo(e,t){if(e.realValues.length<1||e.realValues[1]===null||e.realValues[1]===void 0)return;let r=e.realValues[1],o=t.filter(n=>n.height>0).map(n=>po(n)).reduce((n,a)=>n.concat(a));if(e.mainValues.find(n=>n.name===r)?.type==="string")return Ae(e,o);{let n=Math.min(...o),a=Math.max(...o);return Se(e,null,null,[n,a])}}function po(e,t=[]){return e.children&&e.children.length>0?e.children.forEach(r=>t.concat(po(r,t))):e.data.color&&t.push(e.data.color),t}import{select as I}from"d3";var fo=7,Mt=e=>!!(e.target&&e.target.textAttributes),Nt=(e,t,r)=>{e.selectAll("text").each(function(n,a){let l=tl(n,t,r);this.style=l});let o=at(e);Ja(o),lr(o)},ho=e=>{e.each((t,r,o)=>{I(o[r]).selectAll("text").attr("dx",t.target.textAttributes.dx).attr("dy",t.target.textAttributes.dy).attr("style",t.target.textAttributes.style)})},lr=e=>{let o=a=>a.getBoundingClientRect(),n=[];e.selectAll("text").filter((a,l,i)=>I(i[l]).attr("style")===Oe.high).each((a,l,i)=>n.push(i[l])),e.selectAll("text").filter((a,l,i)=>I(i[l]).attr("style")===Oe.low).each((a,l,i)=>{let c=i[l];n.filter(s=>Xt("x",o(s),o(c))&&Xt("y",o(s),o(c),-2)).forEach(()=>I(c).attr("dy",Number(I(c).attr("dy"))+14))})},go=e=>I(e).style("opacity",ot[I(e).attr("class")]),yo=e=>I(e).style("opacity",null),ot={top:1,mid:.7,lower:0},at=e=>e.filter((t,r,o)=>I(o[r]).selectAll("text").attr("style")!==Oe.zero),Dt=e=>e.selectAll("text").each((t,r,o)=>Qa(o[r])),Ja=e=>e.selectAll("text").each((t,r,o)=>xo(o[r])),xo=e=>{let t=I(e),r=e.getBoundingClientRect();t.attr("dx",0-r.width/2).attr("dy",0+r.height/4)},Qa=e=>{let r=e.parentNode.childNodes[0],o=e.getBBox(),n=r.getBBox();el(e,n,o)||I(e).attr("style",I(e).attr("style"))},el=(e,t,r)=>{let o=Math.min(t.height/r.height,t.width/r.width);if(o<1){let n=parseInt(I(e).style("font-size")),a=Math.floor(n*o);return n>fo&&a>fo?(I(e).style("font-size",`${a}px`),xo(e)):(I(e).style("font-size",null),I(e).style("opacity","0")),!0}return!1},tl=(e,t,r)=>{if(!r.filter(o=>o!=="").every(o=>e.crossValue.includes(o)))return Oe.zero;switch(e.depth){case t+1:return Oe.high;case t+2:return Oe.low;default:return Oe.zero}},Oe={high:"font-size:14px;z-index:5;pointer-events: none;",low:"font-size:8px;opacity:0.7;z-index:4;",zero:"font-size:0px;opacity:0;z-index:4;"};import*as Pt from"d3";var Ft=(e,t)=>{let r=Pt.treemap().size([e,t]).paddingInner(o=>1+2*(o.height-1));return r.tile(Pt.treemapBinary),r};import*as ne from"d3";import{hierarchy as rl,select as ir}from"d3";var nl=(e,t)=>t.every(r=>e.crossValue.includes(r));function sr(e,t,r,o,n,a){ol(e,t,r,o,n),e.mapLevel[o].levelRoot=!0,al(e,a.node().getBoundingClientRect().width,a.node().getBoundingClientRect().height,o),vo(r,o)}function bo(e,t){e.each(r=>{r.mapLevel=[],r.mapLevel[0]={x0:r.x0,x1:Me(r)+r.x0,y0:r.y0,y1:Ne(r)+r.y0,visible:!0,opacity:1}}),t.mapLevel[0].levelRoot=!0,vo(e,0)}var Rt=(e,t)=>{e.each((r,o,n)=>{let a=ir(n[o]).selectAll("text");r.mapLevel[t].textAttributes={dx:a.attr("dx"),dy:a.attr("dy"),class:a.attr("class"),"font-size":a.style("font-size")}})};function ol(e,t,r,o,n){let a={x:e.x0,y:e.y0,width:e.x1-e.x0,height:e.y1-e.y0},l={width:n.x1-n.x0,height:n.y1-n.y0},i={width:l.width/a.width,height:l.height/a.height};r.each(c=>{let s=(c.x0-a.x)*i.width,u=(c.y0-a.y)*i.height,d=Me(c)*i.width,m=Ne(c)*i.height,p=nl(c,t)&&c.data.name!==t[o-1];c.mapLevel[o]={x0:s,x1:d+s,y0:u,y1:m+u,visible:p,opacity:p?1:0}}),e.mapLevel[o].levelRoot=!0}function al(e,t,r,o){let l=Ft(t,r)(rl(e.data).sum(c=>c.size)).descendants(),i=e.descendants();l.forEach((c,s)=>{i[s].mapLevel[o].x0=l[s].x0,i[s].mapLevel[o].x1=l[s].x1,i[s].mapLevel[o].y0=l[s].y0,i[s].mapLevel[o].y1=l[s].y1})}function vo(e,t){e.selectAll("text").each((r,o,n)=>{let a=ir(n[o]),l=ir(n[o]).datum(),i=a.attr("class");l.mapLevel[t].textLockedAt={opacity:ot[i]}})}function wo(e,t,r,o,n,a,l,i,c){if(o.treemapLevel>0){let s=l.crossValue;ur(l,e,t,r,o,n,a,l,0,s,i,c,1,!1),o.treemapRoute.slice(1,o.treemapRoute.length).forEach(u=>{let d=t.filter(p=>p.crossValue===u).datum(),m=d.crossValue;sr(d,m,t,d.depth,l,n),ur(d,e,t,r,o,n,a,l,d.depth,m,i,c,1,!1)})}}function mr(e,t,r,o,n,a,l,i,c,s){if(!e.children)return;n.treemapLevel<e.depth?n.treemapRoute.push(e.crossValue):n.treemapRoute.pop(),n.treemapLevel=e.depth;let u=e.crossValue;(!e.mapLevel[n.treemapLevel]||!e.mapLevel[n.treemapLevel].levelRoot)&&sr(e,u,r,n.treemapLevel,i,a),ur(e,t,r,o,n,a,l,i,n.treemapLevel,u,c,s)}function ur(e,t,r,o,n,a,l,i,c,s,u,d,m=500,p=!0){let f=e.parent,h=l.transition("main transition").duration(m).ease(ne.easeCubicOut);r.each(g=>g.target=g.mapLevel[c]),Mt(e)||cl(r,u),r.transition(h).tween("data",g=>{let x=ne.interpolate(g.current,g.target);return b=>g.current=x(b)}).styleTween("opacity",g=>()=>g.current.opacity).attrTween("pointer-events",g=>()=>g.target.visible?"all":"none"),t.transition(h).filter(g=>g.target.visible).styleTween("x",g=>()=>`${g.current.x0}px`).styleTween("y",g=>()=>`${g.current.y0}px`).styleTween("width",g=>()=>`${g.current.x1-g.current.x0}px`).styleTween("height",g=>()=>`${g.current.y1-g.current.y0}px`),o.transition(h).filter(g=>g.target.visible).attrTween("x",g=>()=>g.current.x0+Me(g.current)/2).attrTween("y",g=>()=>g.current.y0+Ne(g.current)/2).end().catch(()=>cr(r)).then(()=>{Mt(e)||(lr(y),Dt(y),ll(o,l,m),p&&Rt(r,c),cr(r,u,f))}).catch(g=>{console.error("Exception completing promises after main transition",g),cr(r,u,f)}),Mt(e)?ho(r):(o.each((g,x,b)=>go(b[x])),Nt(r,c,s));let y=at(r);f?u.hide(!1).text(e.label).onClick(()=>{mr(f,t,r,o,n,a,l,i,u,d);let g=a.node().getRootNode().host.parentElement;Je(g,f,d)})():u.hide(!0)()}async function ll(e,t,r=400){let o=t.transition("text fade transition").duration(r).ease(ne.easeCubicOut);await e.transition(o).filter(n=>n.target.visible).tween("data",(n,a,l)=>{let i=l[a],c=ne.interpolate(il(n),sl(i));return s=>n.current.opacity=c(s)}).styleTween("opacity",n=>()=>n.current.opacity).end().catch(n=>console.error("Exception in text fade transition",n)).then(()=>e.each((n,a,l)=>yo(l[a])))}var il=e=>e.target.textLockedAt.opacity,sl=e=>ot[ne.select(e).attr("class")],cl=(e,t)=>{t.deactivate(!0),e.each((r,o,n)=>{ne.select(n[o]).selectAll("rect").style("pointer-events","none")})},cr=(e,t)=>{t&&t.deactivate(!1),e.each((r,o,n)=>{ne.select(n[o]).selectAll("rect").style("pointer-events",null)})};var So=`<button id="goto-parent">Goto parent</button>
`;function _o(e){let t=null,r=null,o=!0,n=!1,a=N(e,".parent-controls",()=>e.append("div").attr("class","parent-controls").style("display",o?"none":"").html(So)),l=()=>{a.style("display",o?"none":"").select("#goto-parent").style("pointer-events",n?"none":null).html(`\u21EA ${r}`).on("click",()=>t())};return l.deactivate=(...i)=>{if(!i.length)return n;n=i[0];let c=a.select("#goto-parent");return n?c.style("pointer-events","none"):c.style("pointer-events",null),l},l.hide=(...i)=>i.length?(o=i[0],l):o,l.text=(...i)=>i.length?(r=i[0],l):r,l.onClick=(...i)=>i.length?(t=i[0],l):t,l}var Bt={leaf:"leafnode",branch:"branchnode",root:"rootnode"},Me=e=>e.x1-e.x0,Ne=e=>e.y1-e.y0,ml=(e,t)=>t.depth===e,Vo=(e,t)=>t.depth===0?Bt.root:ml(e,t)?Bt.leaf:Bt.branch;function Co(){let e=null,t=null,r=null,o=null,n=null,a=null,l=i=>{a=_o(n),a();let c=r.height;e.treemapLevel||(e.treemapLevel=0),e.treemapRoute||(e.treemapRoute=[]),Ft(n.node().getBoundingClientRect().width,n.node().getBoundingClientRect().height)(r);let u=i.selectAll("g").data(r.descendants()),d=u.enter().append("g");d.append("rect"),d.append("text");let m=d.merge(u).sort((y,g)=>g.depth-y.depth),p=m.select("rect").attr("class",y=>`treerect ${Vo(c,y)}`).style("x",y=>y.x0).style("y",y=>y.y0).style("width",y=>Me(y)).style("height",y=>Ne(y));p.style("fill",y=>Vo(c,y)===Bt.leaf?y.data.color?o(y.data.color):t.colorStyles.series:"transparent");let f=m.filter(y=>y.value!==0).select("text").attr("x",y=>y.x0+Me(y)/2).attr("y",y=>y.y0+Ne(y)/2).text(y=>y.label),h=p.filter(y=>y.crossValue.length===0).datum();bo(m,h),Nt(m,0,[]),Dt(at(m)),Rt(m,0),e.treemapRoute.length===0&&e.treemapRoute.push(h.crossValue),p.filter(y=>y.children).on("click",(y,g)=>mr(g,p,m,f,e,n,i,h,a,t)),wo(p,m,f,e,n,i,h,a,t)};return l.settings=(...i)=>i.length?(e=i[0],t=i[1],l):e,l.data=(...i)=>i.length?(r=i[0],l):r,l.color=(...i)=>i.length?(o=i[0],l):o,l.container=(...i)=>i.length?(n=i[0],l):n,l}function Ao(e,t){t.treemaps||(t.treemaps={});let r=zt(t),o=mo(t,r.map(c=>c.data));o&&this._container.classList.add("has-legend");let n=We().elementsPrefix("treemap");if(e.datum(r).call(n),o){let c=t.realValues[1];if(t.mainValues.find(s=>s.name===c)?.type==="string"){let s=B().settings(t).scale(o);e.call(s)}else{let s=Ve().scale(o);e.call(s)}}let a=n.chartEnter(),l=n.chartDiv();n.chartTitle().each((c,s,u)=>lt.select(u[s]).text(c.split)),a.merge(l).select("svg").select("g.treemap").each(function({split:c,data:s}){let u=lt.select(this);t.treemaps[c]||(t.treemaps[c]={}),Co().settings(t.treemaps[c],t).data(s).container(lt.select(lt.select(this.parentNode).node().parentNode)).color(o)(u),ge().settings(t).centered(!0)(u.selectAll("g"))})}Ao.plugin={type:"Treemap",name:"Treemap",category:"Hierarchial Chart",max_cells:3e3,max_columns:50,render_warning:!0,initial:{type:"number",count:1,names:["Size","Color","Tooltip"]}};var ko=Ao;var pl=[an,gn,wn,Tn,Mn,Bn,Yn,eo,ro,ko,uo,Xn],pr=pl;import*as dr from"d3";import*as To from"gradient-parser";var Lo=(e,t)=>{if(!t.colorStyles){let r={scheme:[],gradient:{},interpolator:{},grid:{}},o=hl(e);r.series=o("--d3fc-local-series");for(let a=1;;a++){let l=`series-${a}`,i=o(`--d3fc-local-${l}`);if(!i)break;r[l]=i,r.scheme.push(i)}r.opacity=dl(r.series),r.grid.gridLineColor=o`--d3fc-gridline--color`,["full","positive","negative"].forEach(a=>{let l=o(`--d3fc-local-${a}--gradient`);r.gradient[a]=gl(l,r.opacity)}),t.colorStyles=r}if(!t.textStyles){let r=window.getComputedStyle(e),o=r.getPropertyValue("color"),n=`12px ${r.getPropertyValue("font-family")}`;t.textStyles={color:o,font:n}}},dl=e=>dr.color(e).opacity,fl=(e,t)=>{let r=dr.color(`#${e}`);return r.opacity=t,r+""},hl=e=>{let t=getComputedStyle(e);return r=>t?.getPropertyValue(r)},gl=(e,t)=>{let r=To.parse(e)[0].colorStops;return r.map((o,n)=>[o.length?o.length.value/100:n/(r.length-1),fl(o.value,t)]).sort((o,n)=>o[0]-n[0])};var zo=':host .chart{--d3fc-local-full--gradient:var(--d3fc-full--gradient,linear-gradient(#4d342f 0%,#e4521b 22.5%,#feeb65 42.5%,#f0f0f0 50%,#dcedc8 57.5%,#42b3d5 67.5%,#1a237e 100%));--d3fc-local-positive--gradient:var(--d3fc-positive--gradient,linear-gradient(#dcedc8 0%,#42b3d5 35%,#1a237e 100%));--d3fc-local-negative--gradient:var(--d3fc-negative--gradient,linear-gradient(#feeb65 100%,#e4521b 70%,#4d342f 0%));--d3fc-local-series:var(--d3fc-series,rgba(31,119,180,0.5));--d3fc-local-series-1:var(--d3fc-series-1,#0366d6);--d3fc-local-series-2:var(--d3fc-series-2,#ff7f0e);--d3fc-local-series-3:var(--d3fc-series-3,#2ca02c);--d3fc-local-series-4:var(--d3fc-series-4,#d62728);--d3fc-local-series-5:var(--d3fc-series-5,#9467bd);--d3fc-local-series-6:var(--d3fc-series-6,#8c564b);--d3fc-local-series-7:var(--d3fc-series-7,#e377c2);--d3fc-local-series-8:var(--d3fc-series-8,#7f7f7f);--d3fc-local-series-9:var(--d3fc-series-9,#bcbd22);--d3fc-local-series-10:var(--d3fc-series-10,#17becf);}:host .chart .series{fill:var(--d3fc-local-series);}:host .chart .series-1{fill:var(--d3fc-local-series-1);}:host .chart .series-2{fill:var(--d3fc-local-series-2);}:host .chart .series-3{fill:var(--d3fc-local-series-3);}:host .chart .series-4{fill:var(--d3fc-local-series-4);}:host .chart .series-5{fill:var(--d3fc-local-series-5);}:host .chart .series-6{fill:var(--d3fc-local-series-6);}:host .chart .series-7{fill:var(--d3fc-local-series-7);}:host .chart .series-8{fill:var(--d3fc-local-series-8);}:host .chart .series-9{fill:var(--d3fc-local-series-9);}:host .chart .series-10{fill:var(--d3fc-local-series-10);}:host{user-select:none;}:host .chart{position:absolute;box-sizing:border-box;left:0;top:0;width:100%;height:100%;padding:12px;overflow:hidden;}:host .chart.heatmap d3fc-group.cartesian-chart,:host .chart.treemap d3fc-group.cartesian-chart{grid-template-columns:minmax(0em,max-content)auto 1fr auto minmax(0em,max-content);grid-template-rows:minmax(0em,max-content)auto 1fr auto minmax(0em,max-content);}:host .chart .chart-label{display:none;}:host .chart.heatmap{padding-right:120px;}:host .chart.xyscatter{padding:0;font-size:14px;}:host .chart.xyscatter .multi-xlabel{position:absolute;bottom:0;height:2.5em;width:100%;display:flex;justify-content:center;align-items:center;background:var(--d3fc-legend--background);}:host .chart.xyscatter .multi-ylabel{position:absolute;top:0;width:2.5em;height:100%;display:flex;justify-content:center;align-items:center;background:var(--d3fc-legend--background);}:host .chart.xyscatter .outer-container{height:100%;}:host .chart.xyscatter .inner-container{display:inline-grid;overflow-y:auto;width:100%;height:100%;padding:0;margin:0;}:host .chart.xyscatter .inner-container div{overflow:hidden;}:host .chart.xyscatter .inner-container text.segment,:host .chart.xyscatter .inner-container text.parent{text-anchor:middle;user-select:none;pointer-events:none;fill:var(--d3fc-treedata--labels,rgb(51,51,51));}:host .chart.xyscatter .inner-container div.xy-scatter-container{margin:5px 0;}:host .chart.sunburst{padding:0;font-size:14px;}:host .chart.sunburst .outer-container{height:100%;}:host .chart.sunburst .inner-container{width:100%;height:100%;display:inline-grid;padding:0;margin:0;overflow-x:hidden;overflow-y:auto;}:host .chart.sunburst .inner-container div{overflow:hidden;}:host .chart.sunburst .inner-container .sunburst-container:not(:only-child) svg{transform:translate(0,-27px);}:host .chart.sunburst .inner-container svg{width:100%;height:100%;}:host .chart.sunburst .inner-container path{fill:var(--d3fc-series,rgba(31,119,180,0.5));}:host .chart.sunburst .inner-container text.segment,:host .chart.sunburst .inner-container text.parent{text-anchor:middle;user-select:none;pointer-events:none;fill:var(--d3fc-treedata--labels,rgb(51,51,51));}:host .chart.sunburst .inner-container div.title-container{margin-top:5px;}:host .chart.has-legend{padding-right:120px;}:host .chart.treemap .treemap-container{position:relative;}:host .chart.treemap .treemap-container:not(:only-child){width:calc(100% - 12px);height:calc(100% - 12px);}:host .chart.treemap .outer-container{height:100%;}:host .chart.treemap .inner-container{width:100%;height:100%;display:inline-grid;padding:0;margin:0;overflow-x:hidden;overflow-y:auto;}:host .chart.treemap .inner-container div{overflow:hidden;}:host .chart.treemap .inner-container svg{width:100%;height:100%;}:host .chart.treemap .inner-container .treerect{stroke:var(--d3fc-treedata-axis--lines,var(--d3fc-axis--lines,white));fill:var(--d3fc-series,rgba(31,119,180,0.5));}:host .chart.treemap .inner-container .treerect:hover{cursor:pointer;stroke:var(--d3fc-treedata--hover-highlight,black);stroke-opacity:1;}:host .chart.treemap .inner-container .rootnode{opacity:0;pointer-events:none;z-index:0;}:host .chart.treemap .inner-container .branchnode{opacity:0;}:host .chart.treemap .inner-container .branchnode:hover{fill-opacity:0.1;opacity:1;fill:var(--d3fc-treedata--hover-highlight,black);}:host .chart.treemap .inner-container .leafnode{fill-opacity:0.8;}:host .chart.treemap .inner-container .leafnode:hover{fill-opacity:0.5;}:host .chart.treemap .inner-container #hidden{opacity:0;pointer-events:none;z-index:0;}:host .chart.treemap .inner-container .top{font-size:14px;z-index:5;pointer-events:none;}:host .chart.treemap .inner-container .mid{font-size:8px;opacity:0.7;z-index:4;}:host .chart.treemap .inner-container .lower{font-size:0px;opacity:0;z-index:4;}:host .chart.treemap .inner-container text{fill:var(--d3fc-treedata--labels,rgb(51,51,51));}:host .chart.treemap .inner-container text.title{dominant-baseline:hanging;}:host .chart.treemap .inner-container .parent-controls{position:absolute;top:12px;right:auto;left:30px;width:auto;z-index:4;transition:box-shadow 1s;}:host .chart.treemap .inner-container .parent-controls:hover{box-shadow:2px 2px 6px#000;transition:box-shadow 0.2s;}:host .chart .x-label{height:1.2em!important;line-height:1em!important;}:host .chart .x-label,:host .chart .y-label{color:var(--d3fc-label--color,inherit);font-size:14px;}:host .chart d3fc-canvas.plot-area{display:none;}:host .chart.xyscatter d3fc-canvas.plot-area,:host .chart.xyline d3fc-canvas.plot-area,:host .chart.ohlc d3fc-canvas.plot-area,:host .chart.candlestick d3fc-canvas.plot-area,:host .chart.heatmap d3fc-canvas.plot-area{display:block;}:host .chart .y-axis text,:host .chart .x-axis text{fill:var(--d3fc-axis-ticks--color,rgb(80,80,80));font-size:11px;}:host .chart .y-axis path,:host .chart .x-axis path{stroke:var(--d3fc-axis--lines,rgb(180,210,225));}:host .chart .splitter-label{display:inline-block;margin:0 10px;cursor:pointer;}:host .chart .splitter-label::after{margin-left:5px;color:var(--d3fc-axis--lines,rgb(180,210,225));}:host .chart .splitter-label:hover::after{color:var(--d3fc-axis-ticks--color,rgb(80,80,80));}:host .chart .splitter-label.disabled::after{color:rgba(80,80,80,0.3);}:host .chart .splitter-label.disabled{cursor:default;}:host .chart .y-label.left-label .splitter-label::after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:16px;height:12px;-webkit-mask-image:var(--sort-desc-icon--mask-image);mask-image:var(--sort-desc-icon--mask-image);}:host .chart .y-label.right-label .splitter-label::after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:16px;height:12px;-webkit-mask-image:var(--sort-asc-icon--mask-image);mask-image:var(--sort-asc-icon--mask-image);}:host .chart.ybar .y-axis path,:host .chart.yline .y-axis path,:host .chart.xyline .y-axis path,:host .chart.xyline .x-axis path,:host .chart.yarea .y-axis path,:host .chart.yscatter .y-axis path,:host .chart.xyscatter .y-axis path,:host .chart.xyscatter .x-axis path,:host .chart.xbar .x-axis path{visibility:hidden;}:host .chart .y-label{white-space:nowrap;}:host .chart .nearbyTip{fill:var(--d3fc-series,rgba(31,119,180,0.5));}:host #dragHandles{position:absolute;top:0px;right:0px;left:auto;pointer-events:none;}:host #dragHandles rect{pointer-events:all;}:host .label rect{fill:none;}:host .legend-container{position:absolute;top:12px;right:12px;left:auto;width:150px;height:280px;}:host .legend-container.legend-color{width:90px;height:150px;}:host .legend-container[borderbox-on-hover="true"]{transition:box-shadow 1s;}:host .legend-container[borderbox-on-hover="true"]:hover{background-color:var(--d3fc-legend--background,#ffffff);transition:box-shadow 0.2s,background-color 0.2s;}:host .legend-container .legend{font-size:8pt;width:100%;}:host .legend-container .legend .cell{cursor:pointer;}:host .legend-container .legend .cell path{fill:var(--d3fc-series,rgba(31,119,180,0.5));stroke:var(--d3fc-series,rgb(31,119,180));}:host .legend-container .legend .cell.hidden path{fill:rgba(204,204,204,0.5);stroke:rgb(204,204,204);}:host .legend-container .legend .cell.hidden circle{fill:rgb(204,204,204)!important;}:host .legend-container text{fill:var(--d3fc-legend--text,rgb(51,51,51));}:host .legend-container .label:hover{fill:rgb(34,160,206);}:host .legend-container #legend-axis path{stroke:var(--d3fc-legend--text,rgb(51,51,51));}:host .legend-container .legend-controls{margin-left:12px;}:host .legend-container .legend-controls #up-arrow,:host .legend-container .legend-controls #down-arrow{cursor:pointer;color:rgb(31,119,180);}:host .legend-container .legend-controls #up-arrow.disabled,:host .legend-container .legend-controls #down-arrow.disabled{cursor:default;color:rgb(51,51,51);}:host .heatmap .legend-container.legend-color{height:200px;}:host .treemap .legend-container.legend-color{height:200px;}:host .treemap .legend-container:not(.legend-color){width:100px;}:host .zoom-controls{position:absolute;top:10px;left:0;width:100%;text-align:center;}:host .zoom-controls button{-webkit-appearance:none;background:var(--plugin--background,rgb(247,247,247));border:1px solid var(--inactive--color,rgb(204,204,204));color:var(--d3fc-label--color,inherit);font-size:12px;padding:8px;opacity:0.5;cursor:pointer;}:host .zoom-controls button:hover{opacity:1;}:host .parent-controls{position:absolute;top:30px;right:145px;width:100%;text-align:right;}:host .parent-controls button{-webkit-appearance:none;background:rgb(247,247,247);border:1px solid rgb(204,204,204);padding:10px;opacity:0.5;cursor:pointer;}:host .parent-controls button:hover{background:rgb(230,230,230);}:host div.tooltip{position:absolute;text-align:left;font-size:12px;font-weight:300;white-space:nowrap;padding:0.5em;background:var(--d3fc-tooltip--background,#ffffff);color:var(--d3fc-tooltip--color,black);border:1px solid var(--d3fc-tooltip--border-color,#777777);box-shadow:var(--d3fc-tooltip--box-shadow,none);pointer-events:none;}:host div.tooltip ul{margin:0;padding:0;list-style-type:none;}';import*as Ke from"d3";var Eo={initial:{type:"number",count:1},selectMode:"select"},xl=`${zo}${bl()}`,fr=["crossValues","mainValues","realValues","splitValues","filter","data","size","colorStyles","textStyles","agg_paths","treemaps","axisMemo"];function bl(){let e=document.querySelector("head").querySelectorAll("style"),t=[];return e.forEach(r=>{r.innerText.indexOf("d3fc-")!==-1&&t.push(r.innerText)}),t.join("")}function vl(e){customElements.get("perspective-viewer").registerPlugin(e)}function Oo(...e){e=new Set(e.length>0?e:pr.map(t=>t.plugin.name)),pr.forEach(t=>{if(e.has(t.plugin.name)){let r=t.plugin.name.toLowerCase().replace(/[ \t\r\n\/]*/g,""),o=`perspective-viewer-d3fc-${r}`;customElements.define(o,class extends HTMLElement{constructor(){super(),this._chart=null,this._settings=null,this.render_warning=!0}connectedCallback(){this._initialized||(this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=`<style>${xl}</style>`,this.shadowRoot.innerHTML+='<div id="container" class="chart"></div>',this._container=this.shadowRoot.querySelector(".chart"),this._initialized=!0)}get name(){return t.plugin.name}get category(){return t.plugin.category}get select_mode(){return t.plugin.selectMode||"select"}get min_config_columns(){return t.plugin.initial?.count||Eo.initial.count}get config_column_names(){return t.plugin.initial?.names||Eo.initial.names}get max_cells(){return t.plugin.max_cells||4e3}set max_cells(n){t.plugin.max_cells=n}get max_columns(){return t.plugin.max_columns||50}set max_columns(n){t.plugin.max_columns=n}get plugin_attributes(){return{symbol:{symbols:Object.entries(Vt).map(([a,l])=>{let i=document.createElement("div");Ke.select(i).append("svg").attr("viewbox","0, 0, 15, 15").append("path").attr("transform","translate(7.5, 7.5)").attr("d",Ke.symbol(l)());let c=Ke.select(i).html();return i.remove(),{name:a,html:c}})}}}async render(){var n=document.createElement("canvas"),a=this.shadowRoot.querySelector("#container");n.width=a.offsetWidth,n.height=a.offsetHeight;let l=n.getContext("2d");l.fillStyle=window.getComputedStyle(this).getPropertyValue("--plugin--background")||"white",l.fillRect(0,0,n.width,n.height);let i=window.getComputedStyle(this).getPropertyValue("color"),c=Array.from(this.shadowRoot.querySelectorAll("svg:not(#dragHandles)"));for(let m of c.reverse()){var s=document.createElement("img");s.width=m.parentNode.offsetWidth,s.height=m.parentNode.offsetHeight;let p=m.cloneNode(!0);p.hasAttribute("viewBox")||p.setAttribute("viewBox",`0 0 ${s.width} ${s.height}`),p.setAttribute("xmlns","http://www.w3.org/2000/svg");for(let h of p.querySelectorAll("text"))h.setAttribute("fill",i);var u=new XMLSerializer().serializeToString(p);u=u.replace(/[^\x00-\x7F]/g,"");let f=new Promise((h,y)=>{s.onload=h,s.onerror=y});try{s.src=`data:image/svg+xml;base64,${btoa(u)}`,await f}catch{let y=new Promise((g,x)=>{s.onload=g,s.onerror=x});s.src=`data:image/svg+xml;utf8,${u}`,await y}l.drawImage(s,m.parentNode.offsetLeft,m.parentNode.offsetTop,s.width,s.height)}let d=Array.from(this.shadowRoot.querySelectorAll("canvas"));for(let m of d.reverse())l.drawImage(m,m.parentNode.offsetLeft,m.parentNode.offsetTop,m.width/window.devicePixelRatio,m.height/window.devicePixelRatio);return await new Promise(m=>n.toBlob(p=>m(p)),"image/png")}async draw(n,a,l){if(this.offsetParent===null){this._staged_view=[n,a,l];return}this._staged_view=void 0,this._settings&&(this._settings.axisMemo=[[1/0,-1/0],[1/0,-1/0]]),await this.update(n,a,l,!0)}async update(n,a,l,i=!1){if(this.offsetParent===null)return;let c=this.parentElement,s,u,d=t.plugin.name!=="Sunburst";a&&l?s=n.to_columns_string({end_row:l,end_col:a,leaves_only:d}):a?s=n.to_columns_string({end_col:a,leaves_only:d}):l?s=n.to_columns_string({end_row:l,leaves_only:d}):s=n.to_columns_string({leaves_only:d}),u=await Promise.all([c.save(),c.getTable().then(V=>V.schema(!1)),n.expression_schema(!1),n.schema(!1),s,n.get_config()]);let[m,p,f,h,y,g]=u,x=JSON.parse(y),b=Object.keys(x),v={row(V){let T={};for(let Y of b)T[Y]=x[Y][V];return T}};this.config=m;let S=this.config.columns,_=function(V){let T=p[V];return T||(T=f[V]),T},{columns:k,group_by:F,split_by:G,filter:M}=g,z=x[Object.keys(x)[0]]||[],R=F.length>0?z.reduce((V,T,Y)=>{let ce=v.row(Y);if(ce.__ROW_PATH__&&ce.__ROW_PATH__.length==F.length)V.agg_paths.push(V.aggs.slice()),V.rows.push(ce);else{let qe=ce.__ROW_PATH__.filter(w=>w!==void 0).length;V.aggs[qe]=ce,V.aggs=V.aggs.slice(0,qe+1)}return V},{rows:[],aggs:[],agg_paths:[]}):{rows:z.map((V,T)=>v.row(T))},O=(V,T)=>F.length?V:{...V,__ROW_PATH__:[T]},H=R.rows.map(O),J={realValues:S,crossValues:F.map(V=>({name:V,type:_(V)})),mainValues:k.map(V=>({name:V,type:h[V]})),splitValues:G.map(V=>({name:V,type:_(V)})),filter:M,data:H,agg_paths:R.agg_paths,...this.config.plugin_config};this._chart=t;let X={set:(V,T,Y)=>(fr.includes(T)||this._container&&this._container.dispatchEvent(new Event("perspective-plugin-update",{bubbles:!0,composed:!0})),V[T]=Y,!0)},oe=[[1/0,-1/0],[1/0,-1/0]];this._settings=new Proxy({axisMemo:oe,...this._settings,...J},X),this._settings.splitMainValues&&this._settings.splitMainValues.length>=k.length&&(this._settings.splitMainValues=[]),Lo(this._container,this._settings),i&&(this._container.innerHTML=""),this._draw(),await new Promise(V=>requestAnimationFrame(V))}async clear(){this._container&&(this._container.innerHTML="")}_draw(){if(this.offsetParent!==null){let n=Ke.select(this._container),a=`chart ${r}`;this._settings.size=this._container.getBoundingClientRect(),this._settings.data.length>0?this._chart(n.attr("class",a),this._settings):n.attr("class",`${a} disabled`)}}async resize(n){if(this.offsetParent!==null)if(this._settings?.data!==void 0)this._draw();else{let[a,l,i]=this._staged_view;this._staged_view=void 0,this.draw(a,l,i)}}async restyle(...n){let a=this._settings;a&&(delete a.colorStyles,delete a.textStyles,await this.draw(...n))}async delete(){this._container.innerHTML=""}getContainer(){return this._container}save(){let n={...this._settings};return fr.forEach(a=>{delete n[a]}),n}restore(n){let a={};for(let l of fr)this._settings?.[l]!==void 0&&(a[l]=this._settings?.[l]);this._settings={...a,...n}}}),customElements.whenDefined("perspective-viewer").then(()=>vl(o))}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector);Oo("Candlestick");
//# sourceMappingURL=candlestick.js.map
